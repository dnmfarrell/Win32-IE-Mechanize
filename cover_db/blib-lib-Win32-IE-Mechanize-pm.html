<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.17
Devel::Cover is copyright 2001-2012, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: blib/lib/Win32/IE/Mechanize.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">blib/lib/Win32/IE/Mechanize.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">70.2%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>pod</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">package Win32::IE::Mechanize;</td></tr>
<tr><td class="h">2</td><td><div class="c3">13</div><div class="c3">13</div><div class="c3">13</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L2">13</a></div></td><td></td><td><div>2190219</div><div>0</div><div>3001</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">3</td><td><div class="c3">13</div><div class="c3">13</div><div class="c3">13</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L3">13</a></div></td><td></td><td><div>1000</div><div>0</div><div>0</div></td><td class="s">use warnings;</td></tr>
<tr><td class="h">4</td><td colspan="7"></td></tr><tr><td class="h">5</td><td><div class="c3">13</div><div class="c3">13</div><div class="c3">13</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L5">13</a></div></td><td></td><td><div>0</div><div>0</div><div>1000</div></td><td class="s">use vars qw( $VERSION $SLEEP $READYSTATE );</td></tr>
<tr><td class="h">6</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">$VERSION = &#39;0.01&#39;;</td></tr>
<tr><td class="h">7</td><td colspan="7"></td></tr><tr><td class="h">8 - 71</td><td colspan="6"></td><td class="s"><pre>=head1 NAME

Win32::IE::Mechanize - Like &quot;the mech&quot; but with IE as user-agent

=head1 SYNOPSIS

&nbsp;&nbsp;&nbsp;&nbsp;use Win32::IE::Mechanize;

&nbsp;&nbsp;&nbsp;&nbsp;my $ie = Win32::IE::Mechanize-&gt;new( visible =&gt; 1 );

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;get( $url );

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;follow_link( text =&gt; $link_txt );

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;form_name( $form_name );
&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;set_fields(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;username =&gt; &#39;yourname&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password =&gt; &#39;dummy&#39; 
&nbsp;&nbsp;&nbsp;&nbsp;);
&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;click( $btn_name );

&nbsp;&nbsp;&nbsp;&nbsp;# Or all in one go:
&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;submit_form(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form_name =&gt; $form_name,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fields&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;username =&gt; &#39;yourname&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password =&gt; &#39;dummy&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;button&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $btn_name,
&nbsp;&nbsp;&nbsp;&nbsp;);

Now also trys to support Basic-Authentication like LWP::UserAgent

&nbsp;&nbsp;&nbsp;&nbsp;use Win32::IE::Mechanize;

&nbsp;&nbsp;&nbsp;&nbsp;my $ie = Win32::IE::Mechanize-&gt;new( visible =&gt; 1 );

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;credentials( &#39;pause.perl.org:443&#39;, &#39;PAUSE&#39;, &#39;abeltje&#39;, &#39;********&#39; );
&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;get( &#39;https://pause.perl.org/pause/authenquery&#39; );
 
=head1 DESCRIPTION

This module tries to be a sort of drop-in replacement for
L&lt;WWW::Mechanize&gt;. It uses L&lt;Win32::OLE&gt; to manipulate the Internet
Explorer.

Don&#39;t expect it to be like the mech in that the class is not derived
from the user-agent class (like LWP).

B&lt;WARNING&gt;: This is a work in progress and my first priority will be
to implement the C&lt;L&lt;WWW::Mechanize&gt;&gt; interface (which is still in
full development). Where ever possible and needed I will also
implement B&lt;LWP::UserAgent&gt; methods that the mech inherits and will
help make this thing useful.

B&lt;Thank you Andy Lester for C&lt;L&lt;WWW::Mechanize&gt;&gt;. I ported a lot of that
code and nicked most of your documentation!&gt;

For more information on the OLE2 interface for InternetExplorer, google
for B&lt;InternetExplorer.Application+msdn&gt;.

=head1 CONSTRUCTION AND PROPERTIES

=cut</pre></td></tr>
<tr><td class="h">72</td><td colspan="7"></td></tr><tr><td class="h">73</td><td><div class="c3">13</div><div class="c3">13</div><div class="c3">13</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L73">13</a></div></td><td></td><td><div>2001</div><div>6000</div><div>1000</div></td><td class="s">use URI;</td></tr>
<tr><td class="h">74</td><td><div class="c3">13</div><div class="c3">13</div><div class="c3">13</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L74">13</a></div></td><td></td><td><div>30003</div><div>88010</div><div>2000</div></td><td class="s">use Win32::OLE;</td></tr>
<tr><td class="h">75</td><td colspan="7"></td></tr><tr><td class="h">76</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># This was suggested by Bart Lateur</td></tr>
<tr><td class="h">77</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">BEGIN {</td></tr>
<tr><td class="h">78</td><td><div class="c3">13</div><div class="c3">13</div><div class="c3">13</div><div class="c3">13</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L78">13</a></div><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L78">13</a></div></td><td></td><td><div>0</div><div>33002</div><div>35004</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;eval &quot;use Time::HiRes qw/sleep/&quot;;</td></tr>
<tr><td class="h">79</td><td><div class="c3">13</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L79">50</a></div></td><td></td><td></td><td></td><td><div>52006</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$@ or $SLEEP = 0.055;</td></tr>
<tr><td class="h">80</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">81</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">$READYSTATE = 2;</td></tr>
<tr><td class="h">82</td><td colspan="7"></td></tr><tr><td class="h">83</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># These are properties of InternetExplorer.Application we support</td></tr>
<tr><td class="h">84</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">my %ie_property = (</td></tr>
<tr><td class="h">85</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;addressbar =&gt; { type =&gt; &#39;b&#39;, value =&gt; undef },</td></tr>
<tr><td class="h">86</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;fullscreen =&gt; { type =&gt; &#39;b&#39;, value =&gt; undef },</td></tr>
<tr><td class="h">87</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;resizable&nbsp;&nbsp;=&gt; { type =&gt; &#39;b&#39;, value =&gt; undef },</td></tr>
<tr><td class="h">88</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;statusbar&nbsp;&nbsp;=&gt; { type =&gt; &#39;b&#39;, value =&gt; undef },</td></tr>
<tr><td class="h">89</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;toolbar&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { type =&gt; &#39;b&#39;, value =&gt; undef },</td></tr>
<tr><td class="h">90</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;visible&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { type =&gt; &#39;b&#39;, value =&gt; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">91</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;height&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { type =&gt; &#39;n&#39;, value =&gt; undef },</td></tr>
<tr><td class="h">92</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;width&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { type =&gt; &#39;n&#39;, value =&gt; undef },</td></tr>
<tr><td class="h">93</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { type =&gt; &#39;n&#39;, value =&gt; undef },</td></tr>
<tr><td class="h">94</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;top&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; { type =&gt; &#39;n&#39;, value =&gt; undef },</td></tr>
<tr><td class="h">95</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">);</td></tr>
<tr><td class="h">96</td><td colspan="7"></td></tr><tr><td class="h">97 - 105</td><td colspan="6"></td><td class="s"><pre>=head2 Win32::IE::Mechanize-&gt;new( [%options] )

This initialises a new I&lt;InternetExplorer.Application&gt; through
C&lt;L&lt;Win32::OLE&gt;&gt; and sets all the properties that are passed via the
C&lt;%options&gt; hash(ref).

See C&lt;L&lt;set_property()&gt;&gt; for supported options.

=cut</pre></td></tr>
<tr><td class="h">106</td><td colspan="7"></td></tr><tr><td class="h">107</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub new {</td></tr>
<tr><td class="h">108</td><td><div class="c3">16</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L108">16</a></div></td><td><div class="c3">1</div></td><td><div>85011</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $class = shift;</td></tr>
<tr><td class="h">109</td><td colspan="7"></td></tr><tr><td class="h">110</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = bless {</td></tr>
<tr><td class="h">111</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_opt&nbsp;&nbsp;&nbsp;&nbsp;=&gt; {},</td></tr>
<tr><td class="h">112</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quiet&nbsp;&nbsp;&nbsp;=&gt; 0,</td></tr>
<tr><td class="h">113</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onwarn&nbsp;&nbsp;=&gt; \&amp;Win32::IE::Mechanize::__warn,</td></tr>
<tr><td class="h">114</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onerror =&gt; \&amp;Win32::IE::Mechanize::__die,</td></tr>
<tr><td class="h">115</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}, $class;</td></tr>
<tr><td class="h">116</td><td colspan="7"></td></tr><tr><td class="h">117</td><td><div class="c3">16</div><div class="c3">2</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L117">100</a></div><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L117">100</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %opt = @_ ? UNIVERSAL::isa( $_[0], &#39;HASH&#39; ) ? %{ $_[0] } : @_ : ();</td></tr>
<tr><td class="h">118</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{_opt} = { map {</td></tr>
<tr><td class="h">119</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( $_ =&gt; __prop_value( $_, $opt{ $_ } ) )</td></tr>
<tr><td class="h">120</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} grep exists $ie_property{ lc $_ } =&gt; keys %opt };</td></tr>
<tr><td class="h">121</td><td colspan="7"></td></tr><tr><td class="h">122</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# some more options not for IE</td></tr>
<tr><td class="h">123</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{ $_ } = exists $opt{ $_ } ? $opt{ $_ } : undef</td></tr>
<tr><td class="h">124</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L124">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for qw( quiet onwarn onerror );</td></tr>
<tr><td class="h">125</td><td colspan="7"></td></tr><tr><td class="h">126</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;open;</td></tr>
<tr><td class="h">127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">128</td><td colspan="7"></td></tr><tr><td class="h">129 - 177</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;set_property( %opt )

Allows you to set these supported properties:

=over 4

=item B&lt;addressbar&gt;

Set the visibility of the addressbar

=item B&lt;fullscreen&gt;

Set the window of IE to fullscreen (like F11)

=item B&lt;resizable&gt;

Set the resize-ability

=item B&lt;statusbar&gt;

Set the visibility of the statusbar

=item B&lt;toolbar&gt;

Set the visibility of the toolbar

=item B&lt;visible&gt;

Set the visibility of the IE window

=item B&lt;height&gt;

Set the height of the IE window

=item B&lt;width&gt;

Set the width of the IE window

=item B&lt;left&gt;

Set the left coordinate of the IE window

=item B&lt;top&gt;

Set the top-coordinate of the IE window

=back

=cut</pre></td></tr>
<tr><td class="h">178</td><td colspan="7"></td></tr><tr><td class="h">179</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_property {</td></tr>
<tr><td class="h">180</td><td><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L180">6</a></div></td><td><div class="c3">1</div></td><td><div>75007</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">181</td><td colspan="7"></td></tr><tr><td class="h">182</td><td><div class="c3">6</div><div class="c3">1</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L182">100</a></div><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L182">100</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %raw = @_ ? UNIVERSAL::isa( $_[0], &#39;HASH&#39; ) ? %{ $_[0] } : @_ : ();</td></tr>
<tr><td class="h">183</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %opt = map {</td></tr>
<tr><td class="h">184</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( $_ =&gt; __prop_value( $_, $raw{ $_ } ) )</td></tr>
<tr><td class="h">185</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} grep exists $ie_property{ lc $_ } =&gt; keys %raw;</td></tr>
<tr><td class="h">186</td><td colspan="7"></td></tr><tr><td class="h">187</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $prop ( keys %opt ) {</td></tr>
<tr><td class="h">188</td><td><div class="c3">12</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L188">50</a></div></td><td></td><td></td><td></td><td><div>26003</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defined $opt{ $prop } and</td></tr>
<tr><td class="h">189</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{agent}-&gt;{ $prop } = $opt{ $prop };</td></tr>
<tr><td class="h">190</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">192</td><td colspan="7"></td></tr><tr><td class="h">193 - 197</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;close

Close the InternetExplorer instance. Returns true on completion.

=cut</pre></td></tr>
<tr><td class="h">198</td><td colspan="7"></td></tr><tr><td class="h">199</td><td><div class="c3">10</div><div class="c3">10</div><div class="c3">10</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L199">10</a></div></td><td><div class="c3">1</div></td><td><div>7001</div><div>3001</div><div>0</div></td><td class="s">sub close { $_[0]-&gt;{agent}-&gt;quit; $_[0]-&gt;{agent} = undef; 1 }</td></tr>
<tr><td class="h">200</td><td colspan="7"></td></tr><tr><td class="h">201</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub open {</td></tr>
<tr><td class="h">202</td><td><div class="c3">16</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L202">16</a></div></td><td><div class="c0">0</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">203</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L203">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;defined $self-&gt;{agent} and return;</td></tr>
<tr><td class="h">204</td><td><div class="c3">16</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L204">50</a></div></td><td></td><td></td><td></td><td><div>2567253</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{agent} = Win32::OLE-&gt;new( &#39;InternetExplorer.Application&#39; ) or</td></tr>
<tr><td class="h">205</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;die( &quot;Cannot create an InternetExplorer.Application&quot; );</td></tr>
<tr><td class="h">206</td><td><div class="c3">16</div><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $prop ( keys %{ $self-&gt;{_opt} } ) {</td></tr>
<tr><td class="h">207</td><td><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L207">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defined $self-&gt;{_opt}{ $prop } and</td></tr>
<tr><td class="h">208</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{agent}-&gt;{ $prop } = $self-&gt;{_opt}{ $prop };</td></tr>
<tr><td class="h">209</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">210</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td></td><td><div>9001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self;</td></tr>
<tr><td class="h">211</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">212</td><td colspan="7"></td></tr><tr><td class="h">213 - 217</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;agent

Return a reference to the InternetExplorer automation object.

=cut</pre></td></tr>
<tr><td class="h">218</td><td colspan="7"></td></tr><tr><td class="h">219</td><td><div class="c3">10</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L219">10</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">sub agent { $_[0]-&gt;{agent} }</td></tr>
<tr><td class="h">220</td><td colspan="7"></td></tr><tr><td class="h">221 - 228</td><td colspan="6"></td><td class="s"><pre>=head1 PAGE-FETCHING METHODS

=head2 $ie-&gt;get( $url )

This method uses the C&lt;Navigate&gt; method of the IE object to get the C&lt;$url&gt; and
wait for it to be loaded.

=cut</pre></td></tr>
<tr><td class="h">229</td><td colspan="7"></td></tr><tr><td class="h">230</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get {</td></tr>
<tr><td class="h">231</td><td><div class="c3">18</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L231">18</a></div></td><td><div class="c3">1</div></td><td><div>4001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">232</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $agent = $self-&gt;{agent};</td></tr>
<tr><td class="h">233</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $url ) = @_;</td></tr>
<tr><td class="h">234</td><td colspan="7"></td></tr><tr><td class="h">235</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L235">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $uri = $self-&gt;uri </td></tr>
<tr><td class="h">236</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? URI-&gt;new_abs( $url, $self-&gt;uri-&gt;as_string )</td></tr>
<tr><td class="h">237</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: URI-&gt;new( $url );</td></tr>
<tr><td class="h">238</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>49005</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$agent-&gt;navigate({ URL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $uri-&gt;as_string,</td></tr>
<tr><td class="h">239</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Headers =&gt; $self-&gt;_extra_headers( $uri ) });</td></tr>
<tr><td class="h">240</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>201019</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_wait_while_busy;</td></tr>
<tr><td class="h">241</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">242</td><td colspan="7"></td></tr><tr><td class="h">243 - 248</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;reload()

Use the C&lt;Refresh&gt; method of the IE object and wait for it to be
loaded.

=cut</pre></td></tr>
<tr><td class="h">249</td><td colspan="7"></td></tr><tr><td class="h">250</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub reload {</td></tr>
<tr><td class="h">251</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L251">1</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_[0]-&gt;{agent}-&gt;Refresh;</td></tr>
<tr><td class="h">252</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_[0]-&gt;_wait_while_busy;</td></tr>
<tr><td class="h">253</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">254</td><td colspan="7"></td></tr><tr><td class="h">255 - 260</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;back()

Use the C&lt;GoBack&gt; method of the IE object and wait for it to be
loaded.

=cut</pre></td></tr>
<tr><td class="h">261</td><td colspan="7"></td></tr><tr><td class="h">262</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub back {</td></tr>
<tr><td class="h">263</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L263">2</a></div></td><td><div class="c3">1</div></td><td><div>1001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$_[0]-&gt;{agent}-&gt;GoBack;</td></tr>
<tr><td class="h">264</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>8000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$_[0]-&gt;_wait_while_busy;</td></tr>
<tr><td class="h">265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">266</td><td colspan="7"></td></tr><tr><td class="h">267 - 273</td><td colspan="6"></td><td class="s"><pre>=head1 STATUS METHODS

=head2 $ie-&gt;success

Return true for ReadyState &gt;= 2;

=cut</pre></td></tr>
<tr><td class="h">274</td><td colspan="7"></td></tr><tr><td class="h">275</td><td><div class="c3">35</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L275">35</a></div></td><td><div class="c3">1</div></td><td><div>3000</div></td><td class="s">sub success { $_[0]-&gt;{agent}-&gt;ReadyState &gt;= 2 }</td></tr>
<tr><td class="h">276</td><td colspan="7"></td></tr><tr><td class="h">277 - 281</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;uri

Return the URI of this document (as an URI object).

=cut</pre></td></tr>
<tr><td class="h">282</td><td colspan="7"></td></tr><tr><td class="h">283</td><td><div class="c3">35</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L283">35</a></div></td><td><div class="c3">1</div></td><td><div>15003</div></td><td class="s">sub uri { URI-&gt;new( $_[0]-&gt;{agent}-&gt;LocationURL ) }</td></tr>
<tr><td class="h">284</td><td colspan="7"></td></tr><tr><td class="h">285 - 290</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;ct

Fetch the C&lt;mimeType&gt; from the C&lt;&lt; $ie-&gt;Document &gt;&gt;. IE does not
return the MIME type in a way we expect.

=cut</pre></td></tr>
<tr><td class="h">291</td><td colspan="7"></td></tr><tr><td class="h">292</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub ct { </td></tr>
<tr><td class="h">293</td><td><div class="c3">12</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L293">12</a></div></td><td><div class="c3">1</div></td><td><div>12000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $ct = $_[0]-&gt;{agent}-&gt;Document-&gt;mimeType;</td></tr>
<tr><td class="h">294</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>1001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;CASE: {</td></tr>
<tr><td class="h">295</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>5000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $_ = $ct;</td></tr>
<tr><td class="h">296</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L296">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/^HTML/i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and return &quot;text/html&quot;;</td></tr>
<tr><td class="h">297</td><td><div class="c3">5</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L297">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/^Text/i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and return &quot;text/plain&quot;;</td></tr>
<tr><td class="h">298</td><td><div class="c3">3</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L298">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/^(\w+) Image/i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and return &quot;image/\L$1&quot;;</td></tr>
<tr><td class="h">299</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L299">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/^(?:jpe?g|gif|png)/i and return &quot;image/\L$1&quot;;</td></tr>
<tr><td class="h">300</td><td colspan="7"></td></tr><tr><td class="h">301</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return _ct_from_registry( $_ );</td></tr>
<tr><td class="h">302</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">303</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">304</td><td colspan="7"></td></tr><tr><td class="h">305 - 323</td><td colspan="6"></td><td class="s"><pre>=begin private

=head2 _ct_from_registry( $iemime )

This is a bit af a pain:

=over 4

=item * Find a key like C&lt;qr/.+?file/&gt; in HKEY_CLASSES_ROOT with value
$iemime (put it in @fts)

=item * Find a key like C&lt;qr/\..+/&gt; in HKEY_CLASSES_ROOT with value
$ft and a subkey I&lt;Content Type&gt;, that value can be used as Content Type.

=back

=end private

=cut</pre></td></tr>
<tr><td class="h">324</td><td colspan="7"></td></tr><tr><td class="h">325</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _ct_from_registry {</td></tr>
<tr><td class="h">326</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L326">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $iemime = shift;</td></tr>
<tr><td class="h">327</td><td colspan="7"></td></tr><tr><td class="h">328</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;eval q{require Win32::TieRegisrty};</td></tr>
<tr><td class="h">329</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L329">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$@ and return $iemime;</td></tr>
<tr><td class="h">330</td><td colspan="7"></td></tr><tr><td class="h">331</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;Win32::TieRegistry-&gt;import( Delimiter =&gt; &#39;/&#39; );</td></tr>
<tr><td class="h">332</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $Registry = $Win32::TieRegistry::Registry;</td></tr>
<tr><td class="h">333</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @filetypes = grep m|^(.+?file/)$| &amp;&amp;</td></tr>
<tr><td class="h">334</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($Registry-&gt;{ &quot;Classes/$1/&quot; }||&#39;&#39;) eq $iemime</td></tr>
<tr><td class="h">335</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L335">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; keys %{ $Registry-&gt;{&#39;Classes/&#39;} };</td></tr>
<tr><td class="h">336</td><td colspan="7"></td></tr><tr><td class="h">337</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $mimeType = $iemime;</td></tr>
<tr><td class="h">338</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $ft ( @filetypes ) {</td></tr>
<tr><td class="h">339</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( my $ftclean = $ft ) =~ s|/$||;</td></tr>
<tr><td class="h">340</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @exts = grep m|^(\..+?/)$| &amp;&amp;</td></tr>
<tr><td class="h">341</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($Registry-&gt;{ &quot;Classes/$1/&quot; }||&#39;&#39;) eq $ftclean &amp;&amp;</td></tr>
<tr><td class="h">342</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Registry-&gt;{ &quot;Classes/${1}Content Type&quot; }</td></tr>
<tr><td class="h">343</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L343">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; keys %{$Registry-&gt;{&#39;Classes/&#39;}};</td></tr>
<tr><td class="h">344</td><td colspan="7"></td></tr><tr><td class="h">345</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L345">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@exts and $mimeType = $Registry-&gt;{ &quot;Classes/$exts[0]Content Type&quot; };</td></tr>
<tr><td class="h">346</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">347</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $mimeType;</td></tr>
<tr><td class="h">348</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">349</td><td colspan="7"></td></tr><tr><td class="h">350 - 354</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;current_form

Returns the current form as an C&lt;Win32::IE::Form&gt; object.

=cut</pre></td></tr>
<tr><td class="h">355</td><td colspan="7"></td></tr><tr><td class="h">356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub current_form {</td></tr>
<tr><td class="h">357</td><td><div class="c3">57</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L357">57</a></div></td><td><div class="c3">1</div></td><td><div>2000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">358</td><td><div class="c3">57</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L358">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;defined $self-&gt;{cur_form} or $self-&gt;form_number( 1 );</td></tr>
<tr><td class="h">359</td><td><div class="c3">57</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{cur_form};</td></tr>
<tr><td class="h">360</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">361</td><td colspan="7"></td></tr><tr><td class="h">362 - 366</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;is_html

Return true if this is an HTML Document.

=cut</pre></td></tr>
<tr><td class="h">367</td><td colspan="7"></td></tr><tr><td class="h">368</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub is_html {</td></tr>
<tr><td class="h">369</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L369">1</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">370</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;ct eq &#39;text/html&#39;;</td></tr>
<tr><td class="h">371</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">372</td><td colspan="7"></td></tr><tr><td class="h">373 - 377</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;title

Fetch the C&lt;title&gt; from the C&lt;&lt; $ie-&gt;Document &gt;&gt;.

=cut</pre></td></tr>
<tr><td class="h">378</td><td colspan="7"></td></tr><tr><td class="h">379</td><td><div class="c3">7</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L379">7</a></div></td><td><div class="c3">1</div></td><td><div>14001</div></td><td class="s">sub title { $_[0]-&gt;{agent}-&gt;Document-&gt;title }</td></tr>
<tr><td class="h">380</td><td colspan="7"></td></tr><tr><td class="h">381 - 391</td><td colspan="6"></td><td class="s"><pre>=head1 CONTENT-HANDLING METHODS

=head2 $ie-&gt;content

Fetch the C&lt;outerHTML&gt; from the C&lt;&lt; $ie-&gt;Document-&gt;documentElement &gt;&gt;.

I have found no way to get to the exact contents of the document.
This is basically the interpretation of IE of what the HTML looks like
and beware all tags are upcased :(

=cut</pre></td></tr>
<tr><td class="h">392</td><td colspan="7"></td></tr><tr><td class="h">393</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L393">1</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">sub content { $_[0]-&gt;{agent}-&gt;Document-&gt;documentElement-&gt;{outerHTML} }</td></tr>
<tr><td class="h">394</td><td colspan="7"></td></tr><tr><td class="h">395 - 404</td><td colspan="6"></td><td class="s"><pre>=head1 LINK METHODS

=head2 $ie-&gt;links

When called in a list context, returns a list of the links found in
the last fetched page. In a scalar context it returns a reference to
an array with those links. The links returned are all
C&lt;Win32::IE::Link&gt; objects.

=cut</pre></td></tr>
<tr><td class="h">405</td><td colspan="7"></td></tr><tr><td class="h">406</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub links {</td></tr>
<tr><td class="h">407</td><td><div class="c3">30</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L407">30</a></div></td><td><div class="c3">1</div></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">408</td><td colspan="7"></td></tr><tr><td class="h">409</td><td><div class="c3">30</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L409">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;defined $self-&gt;{links} or $self-&gt;{links} = $self-&gt;_extract_links;</td></tr>
<tr><td class="h">410</td><td colspan="7"></td></tr><tr><td class="h">411</td><td><div class="c3">30</div><div class="c3">29</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L411">100</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return wantarray ? @{ $self-&gt;{links} } : $self-&gt;{links};</td></tr>
<tr><td class="h">412</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">413</td><td colspan="7"></td></tr><tr><td class="h">414 - 419</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;follow_link( %opt )

Uses the C&lt;&lt; $self-&gt;find_link() &gt;&gt; interface to locate a link and C&lt;&lt;
$self-&gt;get() &gt;&gt; it.

=cut</pre></td></tr>
<tr><td class="h">420</td><td colspan="7"></td></tr><tr><td class="h">421</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub follow_link {</td></tr>
<tr><td class="h">422</td><td><div class="c3">3</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L422">3</a></div></td><td><div class="c3">1</div></td><td><div>2000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">423</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %parms = ( n =&gt; 1, @_ );</td></tr>
<tr><td class="h">424</td><td colspan="7"></td></tr><tr><td class="h">425</td><td><div class="c3">3</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L425">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $parms{n} eq &quot;all&quot; ) {</td></tr>
<tr><td class="h">426</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $parms{n};</td></tr>
<tr><td class="h">427</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;warn( qq{follow_link( n =&gt; &quot;all&quot; ) is not valid} );</td></tr>
<tr><td class="h">428</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">429</td><td colspan="7"></td></tr><tr><td class="h">430</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $link = $self-&gt;find_link( @_ );</td></tr>
<tr><td class="h">431</td><td><div class="c3">3</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L431">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;get( $link-&gt;url ) if $link;</td></tr>
<tr><td class="h">432</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">433</td><td colspan="7"></td></tr><tr><td class="h">434 - 515</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;find_link( [%options] )

This method finds a link in the currently fetched page. It returns a
L&lt;Win32::IE::Link&gt; object which describes the link.&nbsp;&nbsp;(You&#39;ll probably
be most interested in the C&lt;url()&gt; property.)&nbsp;&nbsp;If it fails to find a
link it returns undef.

You can take the URL part and pass it to the C&lt;get()&gt; method.&nbsp;&nbsp;If that&#39;s
your plan, you might as well use the C&lt;follow_link()&gt; method directly,
since it does the C&lt;get()&gt; for you automatically.

Note that C&lt;&lt; &lt;FRAME SRC=&quot;...&quot;&gt; &gt;&gt; tags are parsed out of the the HTML
and treated as links so this method works with them.

You can select which link to find by passing in one or more of these
key/value pairs:

=over 4

=item * C&lt;&lt; text =&gt; &#39;string&#39;, &gt;&gt; and C&lt;&lt; text_regex =&gt; qr/regex/, &gt;&gt;

C&lt;text&gt; matches the text of the link against I&lt;string&gt;, which must be an
exact match.&nbsp;&nbsp;To select a link with text that is exactly &quot;download&quot;, use

&nbsp;&nbsp;&nbsp;&nbsp;$mech-&gt;find_link( text =&gt; &quot;download&quot; );

C&lt;text_regex&gt; matches the text of the link against I&lt;regex&gt;.&nbsp;&nbsp;To select a
link with text that has &quot;download&quot; anywhere in it, regardless of case, use

&nbsp;&nbsp;&nbsp;&nbsp;$mech-&gt;find_link( text_regex =&gt; qr/download/i );

Note that the text extracted from the page&#39;s links are trimmed.&nbsp;&nbsp;For
example, C&lt;&lt; &lt;a&gt; foo &lt;/a&gt; &gt;&gt; is stored as &#39;foo&#39;, and searching for
leading or trailing spaces will fail.

=item * C&lt;&lt; url =&gt; &#39;string&#39;, &gt;&gt; and C&lt;&lt; url_regex =&gt; qr/regex/, &gt;&gt;

Matches the URL of the link against I&lt;string&gt; or I&lt;regex&gt;, as appropriate.
The URL may be a relative URL, like F&lt;foo/bar.html&gt;, depending on how
it&#39;s coded on the page.

=item * C&lt;&lt; url_abs =&gt; string &gt;&gt; and C&lt;&lt; url_abs_regex =&gt; regex &gt;&gt;

Matches the absolute URL of the link against I&lt;string&gt; or I&lt;regex&gt;,
as appropriate.&nbsp;&nbsp;The URL will be an absolute URL, even if it&#39;s relative
in the page.

=item * C&lt;&lt; name =&gt; string &gt;&gt; and C&lt;&lt; name_regex =&gt; regex &gt;&gt;

Matches the name of the link against I&lt;string&gt; or I&lt;regex&gt;, as appropriate.

=item * C&lt;&lt; tag =&gt; string &gt;&gt; and C&lt;&lt; tag_regex =&gt; regex &gt;&gt;

Matches the tag that the link came from against I&lt;string&gt; or I&lt;regex&gt;,
as appropriate.&nbsp;&nbsp;The C&lt;tag_regex&gt; is probably most useful to check for
more than one tag, as in:

&nbsp;&nbsp;&nbsp;&nbsp;$mech-&gt;find_link( tag_regex =&gt; qr/^(a|frame)$/ );

The tags and attributes looked at are defined below, at
L&lt;$mech-&gt;find_link() : link format&gt;.

=item * C&lt;&lt; n =&gt; number &gt;&gt;

=back

The C&lt;n&gt; parms can be combined with the C&lt;text*&gt; or C&lt;url*&gt; parms
as a numeric modifier.&nbsp;&nbsp;For example,
C&lt;&lt; text =&gt; &quot;download&quot;, n =&gt; 3 &gt;&gt; finds the 3rd link which has the
exact text &quot;download&quot;.

If C&lt;n&gt; is not specified, it defaults to 1.&nbsp;&nbsp;Therefore, if you don&#39;t
specify any parms, this method defaults to finding the first link on the
page.

Note that you can specify multiple text or URL parameters, which
will be ANDed together.&nbsp;&nbsp;For example, to find the first link with
text of &quot;News&quot; and with &quot;cnn.com&quot; in the URL, use:

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;find_link( text =&gt; &quot;News&quot;, url_regex =&gt; qr/cnn\.com/ );

=cut</pre></td></tr>
<tr><td class="h">516</td><td colspan="7"></td></tr><tr><td class="h">517</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_link {</td></tr>
<tr><td class="h">518</td><td><div class="c3">28</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L518">28</a></div></td><td><div class="c3">1</div></td><td><div>11003</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">519</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %parms = ( n=&gt;1, @_ );</td></tr>
<tr><td class="h">520</td><td colspan="7"></td></tr><tr><td class="h">521</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $wantall = ( $parms{n} eq &quot;all&quot; );</td></tr>
<tr><td class="h">522</td><td colspan="7"></td></tr><tr><td class="h">523</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_clean_keys( </td></tr>
<tr><td class="h">524</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\%parms,</td></tr>
<tr><td class="h">525</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qr/^(n|(text|url|url_abs|name|tag)(_regex)?)$/ </td></tr>
<tr><td class="h">526</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">527</td><td colspan="7"></td></tr><tr><td class="h">528</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L528">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @links = $self-&gt;links or return;</td></tr>
<tr><td class="h">529</td><td colspan="7"></td></tr><tr><td class="h">530</td><td><div class="c3">27</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $nmatches = 0;</td></tr>
<tr><td class="h">531</td><td><div class="c3">27</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @matches;</td></tr>
<tr><td class="h">532</td><td><div class="c3">27</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $link ( @links ) {</td></tr>
<tr><td class="h">533</td><td><div class="c3">224</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L533">100</a></div></td><td></td><td></td><td></td><td><div>19001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( _match_any_link_parms($link,\%parms) ) {</td></tr>
<tr><td class="h">534</td><td><div class="c3">61</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L534">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $wantall ) {</td></tr>
<tr><td class="h">535</td><td><div class="c3">30</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @matches, $link );</td></tr>
<tr><td class="h">536</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">537</td><td><div class="c3">31</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++$nmatches;</td></tr>
<tr><td class="h">538</td><td><div class="c3">31</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L538">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $link if $nmatches &gt;= $parms{n};</td></tr>
<tr><td class="h">539</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">540</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">541</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} # for @links</td></tr>
<tr><td class="h">542</td><td colspan="7"></td></tr><tr><td class="h">543</td><td><div class="c3">10</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L543">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $wantall ) {</td></tr>
<tr><td class="h">544</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L544">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return @matches if wantarray;</td></tr>
<tr><td class="h">545</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return \@matches;</td></tr>
<tr><td class="h">546</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">547</td><td colspan="7"></td></tr><tr><td class="h">548</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">549</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">550</td><td colspan="7"></td></tr><tr><td class="h">551</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Stolen from WWW::Mechanize-1.08</td></tr>
<tr><td class="h">552</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Used by find_links to check for matches</td></tr>
<tr><td class="h">553</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># The logic is such that ALL parm criteria that are given must match</td></tr>
<tr><td class="h">554</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _match_any_link_parms {</td></tr>
<tr><td class="h">555</td><td><div class="c3">224</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L555">224</a></div></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $link = shift;</td></tr>
<tr><td class="h">556</td><td><div class="c3">224</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $p = shift;</td></tr>
<tr><td class="h">557</td><td colspan="7"></td></tr><tr><td class="h">558</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# No conditions, anything matches</td></tr>
<tr><td class="h">559</td><td><div class="c3">224</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L559">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 unless keys %$p;</td></tr>
<tr><td class="h">560</td><td colspan="7"></td></tr><tr><td class="h">561</td><td><div class="c3">224</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L561">100</a></div></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L561">100</a></div></td><td></td><td></td><td><div>2000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{url}</td></tr>
<tr><td class="h">562</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( $link-&gt;url eq $p-&gt;{url} );</td></tr>
<tr><td class="h">563</td><td><div class="c3">192</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L563">100</a></div></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L563">100</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{url_regex}</td></tr>
<tr><td class="h">564</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( $link-&gt;url =~ $p-&gt;{url_regex} );</td></tr>
<tr><td class="h">565</td><td><div class="c3">149</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L565">50</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L565">33</a></div></td><td></td><td></td><td><div>1001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{url_abs}</td></tr>
<tr><td class="h">566</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( $link-&gt;url_abs eq $p-&gt;{url_abs} );</td></tr>
<tr><td class="h">567</td><td><div class="c3">149</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L567">50</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L567">33</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{url_abs_regex}</td></tr>
<tr><td class="h">568</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( $link-&gt;url_abs =~ $p-&gt;{url_abs_regex} );</td></tr>
<tr><td class="h">569</td><td><div class="c3">149</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L569">100</a></div></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L569">100</a></div><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L569">67</a></div></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{text}</td></tr>
<tr><td class="h">570</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( defined($link-&gt;text) and $link-&gt;text eq $p-&gt;{text} );</td></tr>
<tr><td class="h">571</td><td><div class="c3">122</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L571">100</a></div></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L571">100</a></div><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L571">67</a></div></td><td></td><td></td><td><div>2000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{text_regex}</td></tr>
<tr><td class="h">572</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( defined($link-&gt;text) and $link-&gt;text =~ $p-&gt;{text_regex} );</td></tr>
<tr><td class="h">573</td><td><div class="c3">75</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L573">100</a></div></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L573">100</a></div><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L573">67</a></div></td><td></td><td></td><td><div>2001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{name}</td></tr>
<tr><td class="h">574</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( defined($link-&gt;name) and $link-&gt;name eq $p-&gt;{name} );</td></tr>
<tr><td class="h">575</td><td><div class="c3">72</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L575">100</a></div></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L575">100</a></div><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L575">67</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{name_regex}</td></tr>
<tr><td class="h">576</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( defined($link-&gt;name) and $link-&gt;name =~ $p-&gt;{name_regex} );</td></tr>
<tr><td class="h">577</td><td><div class="c3">64</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L577">100</a></div></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L577">100</a></div><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L577">67</a></div></td><td></td><td></td><td><div>2000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{tag}</td></tr>
<tr><td class="h">578</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( $link-&gt;tag and lc( $link-&gt;tag ) eq lc( $p-&gt;{tag} ) );</td></tr>
<tr><td class="h">579</td><td><div class="c3">61</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L579">50</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L579">67</a></div><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L579">33</a></div></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{tag_regex}</td></tr>
<tr><td class="h">580</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( $link-&gt;tag and $link-&gt;tag =~ $p-&gt;{tag_regex} );</td></tr>
<tr><td class="h">581</td><td colspan="7"></td></tr><tr><td class="h">582</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Success: everything that was defined passed.</td></tr>
<tr><td class="h">583</td><td><div class="c3">61</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">584</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">585</td><td colspan="7"></td></tr><tr><td class="h">586</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Cleans the %parms parameter for the find_link and find_image methods.</td></tr>
<tr><td class="h">587</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _clean_keys {</td></tr>
<tr><td class="h">588</td><td><div class="c3">31</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L588">31</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">589</td><td><div class="c3">31</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $parms = shift;</td></tr>
<tr><td class="h">590</td><td><div class="c3">31</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $rx_keyname = shift;</td></tr>
<tr><td class="h">591</td><td colspan="7"></td></tr><tr><td class="h">592</td><td><div class="c3">31</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $key ( keys %$parms ) {</td></tr>
<tr><td class="h">593</td><td><div class="c3">61</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $val = $parms-&gt;{$key};</td></tr>
<tr><td class="h">594</td><td><div class="c3">61</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L594">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $key !~ qr/$rx_keyname/ ) {</td></tr>
<tr><td class="h">595</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;warn( qq{Unknown link-finding parameter &quot;$key&quot;} );</td></tr>
<tr><td class="h">596</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $parms-&gt;{$key};</td></tr>
<tr><td class="h">597</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">598</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">599</td><td colspan="7"></td></tr><tr><td class="h">600</td><td><div class="c3">61</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key_regex = ( $key =~ /_regex$/ );</td></tr>
<tr><td class="h">601</td><td><div class="c3">61</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $val_regex = ( ref($val) eq &quot;Regexp&quot; );</td></tr>
<tr><td class="h">602</td><td colspan="7"></td></tr><tr><td class="h">603</td><td><div class="c3">61</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L603">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $key_regex ) {</td></tr>
<tr><td class="h">604</td><td><div class="c3">15</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L604">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( !$val_regex ) {</td></tr>
<tr><td class="h">605</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;warn( qq{$val passed as $key is not a regex} );</td></tr>
<tr><td class="h">606</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $parms-&gt;{$key};</td></tr>
<tr><td class="h">607</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">608</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">609</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">610</td><td><div class="c3">46</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L610">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $val_regex ) {</td></tr>
<tr><td class="h">611</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;warn( qq{$val passed as &#39;$key&#39; is a regex} );</td></tr>
<tr><td class="h">612</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $parms-&gt;{$key};</td></tr>
<tr><td class="h">613</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">614</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">615</td><td><div class="c3">46</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L615">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $val =~ /^\s|\s$/ ) {</td></tr>
<tr><td class="h">616</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;warn( qq{&#39;$val&#39; is space-padded and cannot succeed} );</td></tr>
<tr><td class="h">617</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $parms-&gt;{$key};</td></tr>
<tr><td class="h">618</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">619</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">620</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} # for keys %parms</td></tr>
<tr><td class="h">622</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">} # _clean_keys()</td></tr>
<tr><td class="h">623</td><td colspan="7"></td></tr><tr><td class="h">624 - 637</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;find_all_links( %opt )

Returns all the links on the current page that match the criteria.
The method for specifying link criteria is the same as in
C&lt;find_link()&gt;.&nbsp;&nbsp;Each of the links returned is in the same format
as in C&lt;find_link()&gt;.

In list context, C&lt;find_all_links()&gt; returns a list of the links.
Otherwise, it returns a reference to the list of links.

C&lt;find_all_links()&gt; with no parameters returns all links in the
page.

=cut</pre></td></tr>
<tr><td class="h">638</td><td colspan="7"></td></tr><tr><td class="h">639</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_all_links {</td></tr>
<tr><td class="h">640</td><td><div class="c3">5</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L640">5</a></div></td><td><div class="c3">1</div></td><td><div>4000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">641</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;find_link( @_, n =&gt; &#39;all&#39; );</td></tr>
<tr><td class="h">642</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">643</td><td colspan="7"></td></tr><tr><td class="h">644 - 658</td><td colspan="6"></td><td class="s"><pre>=head1 IMAGE METHODS

=head2 $ie-&gt;images

Lists all the images on the current page.&nbsp;&nbsp;Each image is a
Win32::IE::Image object. In list context, returns a list of all
images.&nbsp;&nbsp;In scalar context, returns an array reference of all images.

B&lt;NOTE&gt;: Althoug L&lt;WWW::Mechanize&gt; explicitly only supports 
&nbsp;&nbsp;&nbsp;&nbsp;&lt;INPUT type=submit src=&quot;...&quot;&gt;
constructs, this is B&lt;not&gt; supported by IE, it must be:
&nbsp;&nbsp;&nbsp;&nbsp;&lt;INPUT type=image src=&quot;...&quot;&gt;
for IE to behave as expected.
 
=cut</pre></td></tr>
<tr><td class="h">659</td><td colspan="7"></td></tr><tr><td class="h">660</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub images {</td></tr>
<tr><td class="h">661</td><td><div class="c3">4</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L661">4</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">662</td><td colspan="7"></td></tr><tr><td class="h">663</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L663">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_extract_images unless defined $self-&gt;{images};</td></tr>
<tr><td class="h">664</td><td colspan="7"></td></tr><tr><td class="h">665</td><td><div class="c3">4</div><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L665">50</a></div></td><td></td><td></td><td></td><td><div>0</div><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return wantarray ? @{ $self-&gt;{images} } : $self-&gt;{images};</td></tr>
<tr><td class="h">666</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">667</td><td colspan="7"></td></tr><tr><td class="h">668 - 730</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;find_image()

Finds an image in the current page. It returns a
L&lt;Win32::IE::Image&gt; object which describes the image.&nbsp;&nbsp;If it fails
to find an image it returns undef.

You can select which link to find by passing in one or more of these
key/value pairs:

=over 4

=item * C&lt;&lt; alt =&gt; &#39;string&#39; &gt;&gt; and C&lt;&lt; alt_regex =&gt; qr/regex/, &gt;&gt;

C&lt;alt&gt; matches the ALT attribute of the image against I&lt;string&gt;, which must be a
n
exact match. To select a image with an ALT tag that is exactly &quot;download&quot;, use

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;find_image( alt&nbsp;&nbsp;=&gt; &quot;download&quot; );

C&lt;alt_regex&gt; matches the ALT attribute of the image&nbsp;&nbsp;against a regular
expression.&nbsp;&nbsp;To select an image with an ALT attribute that has &quot;download&quot;
anywhere in it, regardless of case, use

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;find_image( alt_regex =&gt; qr/download/i );

=item * C&lt;&lt; url =&gt; &#39;string&#39;, &gt;&gt; and C&lt;&lt; url_regex =&gt; qr/regex/, &gt;&gt;

Matches the URL of the image against I&lt;string&gt; or I&lt;regex&gt;, as appropriate.
The URL may be a relative URL, like F&lt;foo/bar.html&gt;, depending on how
it&#39;s coded on the page.

=item * C&lt;&lt; url_abs =&gt; string &gt;&gt; and C&lt;&lt; url_abs_regex =&gt; regex &gt;&gt;

Matches the absolute URL of the image against I&lt;string&gt; or I&lt;regex&gt;,
as appropriate.&nbsp;&nbsp;The URL will be an absolute URL, even if it&#39;s relative
in the page.

=item * C&lt;&lt; tag =&gt; string &gt;&gt; and C&lt;&lt; tag_regex =&gt; regex &gt;&gt;

Matches the tag that the image came from against I&lt;string&gt; or I&lt;regex&gt;,
as appropriate.&nbsp;&nbsp;The C&lt;tag_regex&gt; is probably most useful to check for
more than one tag, as in:

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;find_image( tag_regex =&gt; qr/^(img|input)$/ );

The tags supported are C&lt;&lt; &lt;img&gt; &gt;&gt; and C&lt;&lt; &lt;input&gt; &gt;&gt;.

=back

If C&lt;n&gt; is not specified, it defaults to 1.&nbsp;&nbsp;Therefore, if you don&#39;t
specify any parms, this method defaults to finding the first image on the
page.

Note that you can specify multiple ALT or URL parameters, which
will be ANDed together.&nbsp;&nbsp;For example, to find the first image with
ALT text of &quot;News&quot; and with &quot;cnn.com&quot; in the URL, use:

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;find_image( image =&gt; &quot;News&quot;, url_regex =&gt; qr/cnn\.com/ );

The return value is a reference to an array containing a
L&lt;Win32::IE::Image&gt; object for every image in C&lt;&lt; $self-&gt;content &gt;&gt;.

=cut</pre></td></tr>
<tr><td class="h">731</td><td colspan="7"></td></tr><tr><td class="h">732</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_image {</td></tr>
<tr><td class="h">733</td><td><div class="c3">3</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L733">3</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">734</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %parms = ( n=&gt;1, @_ );</td></tr>
<tr><td class="h">735</td><td colspan="7"></td></tr><tr><td class="h">736</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $wantall = ( $parms{n} eq &quot;all&quot; );</td></tr>
<tr><td class="h">737</td><td colspan="7"></td></tr><tr><td class="h">738</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_clean_keys( \%parms, qr/^(n|(alt|url|url_abs|tag)(_regex)?)$/ );</td></tr>
<tr><td class="h">739</td><td colspan="7"></td></tr><tr><td class="h">740</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L740">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @images = $self-&gt;images or return;</td></tr>
<tr><td class="h">741</td><td colspan="7"></td></tr><tr><td class="h">742</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $nmatches = 0;</td></tr>
<tr><td class="h">743</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @matches;</td></tr>
<tr><td class="h">744</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $image ( @images ) {</td></tr>
<tr><td class="h">745</td><td><div class="c3">4</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L745">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( _match_any_image_parms($image,\%parms) ) {</td></tr>
<tr><td class="h">746</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L746">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $wantall ) {</td></tr>
<tr><td class="h">747</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @matches, $image );</td></tr>
<tr><td class="h">748</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">749</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++$nmatches;</td></tr>
<tr><td class="h">750</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L750">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $image if $nmatches &gt;= $parms{n};</td></tr>
<tr><td class="h">751</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">752</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">753</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} # for @images</td></tr>
<tr><td class="h">754</td><td colspan="7"></td></tr><tr><td class="h">755</td><td><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L755">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $wantall ) {</td></tr>
<tr><td class="h">756</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L756">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return @matches if wantarray;</td></tr>
<tr><td class="h">757</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return \@matches;</td></tr>
<tr><td class="h">758</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">759</td><td colspan="7"></td></tr><tr><td class="h">760</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">761</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">762</td><td colspan="7"></td></tr><tr><td class="h">763</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Used by find_images to check for matches</td></tr>
<tr><td class="h">764</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># The logic is such that ALL parm criteria that are given must match</td></tr>
<tr><td class="h">765</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _match_any_image_parms {</td></tr>
<tr><td class="h">766</td><td><div class="c3">4</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L766">4</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $image = shift;</td></tr>
<tr><td class="h">767</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $p = shift;</td></tr>
<tr><td class="h">768</td><td colspan="7"></td></tr><tr><td class="h">769</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# No conditions, anything matches</td></tr>
<tr><td class="h">770</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L770">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 unless keys %$p;</td></tr>
<tr><td class="h">771</td><td colspan="7"></td></tr><tr><td class="h">772</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L772">50</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L772">33</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{url}</td></tr>
<tr><td class="h">773</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( $image-&gt;url eq $p-&gt;{url} );</td></tr>
<tr><td class="h">774</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L774">50</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L774">33</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{url_regex}</td></tr>
<tr><td class="h">775</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( $image-&gt;url =~ $p-&gt;{url_regex} );</td></tr>
<tr><td class="h">776</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L776">50</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L776">33</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{url_abs}</td></tr>
<tr><td class="h">777</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( $image-&gt;url_abs eq $p-&gt;{url_abs} );</td></tr>
<tr><td class="h">778</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L778">50</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L778">33</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{url_abs_regex}</td></tr>
<tr><td class="h">779</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( $image-&gt;url_abs =~ $p-&gt;{url_abs_regex} );</td></tr>
<tr><td class="h">780</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L780">50</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L780">67</a></div><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L780">33</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{alt}</td></tr>
<tr><td class="h">781</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( defined($image-&gt;alt) and $image-&gt;alt eq $p-&gt;{alt} );</td></tr>
<tr><td class="h">782</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L782">50</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L782">67</a></div><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L782">33</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{alt_regex}</td></tr>
<tr><td class="h">783</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( defined($image-&gt;alt) and $image-&gt;alt =~ $p-&gt;{alt_regex} );</td></tr>
<tr><td class="h">784</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L784">50</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L784">33</a></div><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L784">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{tag}</td></tr>
<tr><td class="h">785</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( $image-&gt;tag and lc( $image-&gt;tag ) eq lc( $p-&gt;{tag} ) );</td></tr>
<tr><td class="h">786</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L786">50</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L786">33</a></div><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L786">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if defined $p-&gt;{tag_regex}</td></tr>
<tr><td class="h">787</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and !( $image-&gt;tag and $image-&gt;tag =~ $p-&gt;{tag_regex} );</td></tr>
<tr><td class="h">788</td><td colspan="7"></td></tr><tr><td class="h">789</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Success: everything that was defined passed.</td></tr>
<tr><td class="h">790</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">791</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">792</td><td colspan="7"></td></tr><tr><td class="h">793 - 806</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;find_all_images( ... )

Returns all the images on the current page that match the criteria.&nbsp;&nbsp;The
method for specifying image criteria is the same as in C&lt;L&lt;find_image()&gt;&gt;.
Each of the images returned is a L&lt;Win32::IE::Image&gt; object.

In list context, C&lt;find_all_images()&gt; returns a list of the images.
Otherwise, it returns a reference to the list of images.

C&lt;find_all_images()&gt; with no parameters returns all images in the
page.


=cut</pre></td></tr>
<tr><td class="h">807</td><td colspan="7"></td></tr><tr><td class="h">808</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_all_images {</td></tr>
<tr><td class="h">809</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L809">1</a></div></td><td><div class="c3">1</div></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">810</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;find_image( @_, n=&gt;&#39;all&#39; );</td></tr>
<tr><td class="h">811</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">812</td><td colspan="7"></td></tr><tr><td class="h">813 - 821</td><td colspan="6"></td><td class="s"><pre>=head1 FORM METHODS

=head2 $ie-&gt;forms

Lists all the forms on the current page.&nbsp;&nbsp;Each form is an
Win32::IE::Form object.&nbsp;&nbsp;In list context, returns a list of all forms.
In scalar context, returns an array reference of all forms.

=cut</pre></td></tr>
<tr><td class="h">822</td><td colspan="7"></td></tr><tr><td class="h">823</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub forms {</td></tr>
<tr><td class="h">824</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L824">1</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift ;</td></tr>
<tr><td class="h">825</td><td><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L825">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_extract_forms unless defined $self-&gt;{forms};</td></tr>
<tr><td class="h">826</td><td colspan="7"></td></tr><tr><td class="h">827</td><td><div class="c3">1</div><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L827">50</a></div></td><td></td><td></td><td></td><td><div>1000</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return wantarray ? @{ $self-&gt;{forms} } : $self-&gt;{forms};</td></tr>
<tr><td class="h">828</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">829</td><td colspan="7"></td></tr><tr><td class="h">830 - 837</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;form_number( $number )

Selects the numberth form on the page as the target for subsequent
calls to field() and click().&nbsp;&nbsp;Also returns the form that was
selected.&nbsp;&nbsp;Emits a warning and returns undef if there is no such form.
Forms are indexed from 1, so the first form is number 1, not zero.

=cut</pre></td></tr>
<tr><td class="h">838</td><td colspan="7"></td></tr><tr><td class="h">839</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub form_number {</td></tr>
<tr><td class="h">840</td><td><div class="c3">14</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L840">14</a></div></td><td><div class="c3">1</div></td><td><div>4000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">841</td><td colspan="7"></td></tr><tr><td class="h">842</td><td><div class="c3">14</div></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L842">100</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $number = shift || 1;</td></tr>
<tr><td class="h">843</td><td><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L843">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_extract_forms unless defined $self-&gt;{forms};</td></tr>
<tr><td class="h">844</td><td><div class="c3">14</div><div class="c3">14</div><div class="c3">14</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L844">100</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L844">67</a></div></td><td></td><td></td><td><div>0</div><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( @{ $self-&gt;{forms} } &amp;&amp; $number &lt;= @{ $self-&gt;{forms} } ) {</td></tr>
<tr><td class="h">845</td><td><div class="c3">13</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{cur_form} = $self-&gt;{forms}[ $number - 1 ];</td></tr>
<tr><td class="h">846</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">847</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;warn( &quot;There is no form numbered $number.&quot; );</td></tr>
<tr><td class="h">848</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return undef;</td></tr>
<tr><td class="h">849</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">850</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">851</td><td colspan="7"></td></tr><tr><td class="h">852 - 859</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;form_name( $name )

Selects a form by name.&nbsp;&nbsp;If there is more than one form on the page
with that name, then the first one is used, and a warning is
generated.&nbsp;&nbsp;Also returns the form itself, or undef if it is not
found.

=cut</pre></td></tr>
<tr><td class="h">860</td><td colspan="7"></td></tr><tr><td class="h">861</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub form_name {</td></tr>
<tr><td class="h">862</td><td><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L862">6</a></div></td><td><div class="c3">1</div></td><td><div>3000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">863</td><td colspan="7"></td></tr><tr><td class="h">864</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L864">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift or return undef;</td></tr>
<tr><td class="h">865</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L865">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_extract_forms unless defined $self-&gt;{forms};</td></tr>
<tr><td class="h">866</td><td><div class="c3">6</div><div class="c3">6</div></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L866">100</a></div></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @matches = grep $_-&gt;name &amp;&amp; $_-&gt;name eq $name =&gt; @{ $self-&gt;{forms} };</td></tr>
<tr><td class="h">867</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L867">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( @matches ) {</td></tr>
<tr><td class="h">868</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L868">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;warn( &quot;There are &quot; . scalar @matches . &quot;forms named &#39;$name&#39;. &quot; .</td></tr>
<tr><td class="h">869</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;The first one was used.&quot; ) if @matches &gt; 1;</td></tr>
<tr><td class="h">870</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{cur_form} = $matches[0];</td></tr>
<tr><td class="h">871</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">872</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;warn( &quot;There is no form named &#39;$name&#39;.&quot; );</td></tr>
<tr><td class="h">873</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return undef;</td></tr>
<tr><td class="h">874</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">875</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">876</td><td colspan="7"></td></tr><tr><td class="h">877 - 888</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;field( $name[, $value[, $index]] )

=head2 $ie-&gt;field( $name, \@values[, $number ] )

Given the name of a field, set its value to the value specified.&nbsp;&nbsp;This
applies to the current form (as set by the C&lt;L&lt;form_name()&gt;&gt; or
C&lt;L&lt;form_number()&gt;&gt; method or defaulting to the first form on the page).

The optional I&lt;$index&gt; parameter is used to distinguish between two fields
with the same name. The fields are numbered from 1.

=cut</pre></td></tr>
<tr><td class="h">889</td><td colspan="7"></td></tr><tr><td class="h">890</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub field {</td></tr>
<tr><td class="h">891</td><td><div class="c3">19</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L891">19</a></div></td><td><div class="c3">1</div></td><td><div>8000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $self, $name, $value, $index ) = @_;</td></tr>
<tr><td class="h">892</td><td><div class="c3">19</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $form = $self-&gt;current_form;</td></tr>
<tr><td class="h">893</td><td colspan="7"></td></tr><tr><td class="h">894</td><td><div class="c3">19</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @inputs = $form-&gt;find_input( $name );</td></tr>
<tr><td class="h">895</td><td><div class="c3">19</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L895">50</a></div></td><td></td><td></td><td></td><td><div>2001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@inputs or $self-&gt;warn( &quot;No &#39;$name&#39; parameter exists&quot; );</td></tr>
<tr><td class="h">896</td><td><div class="c3">19</div></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L896">50</a></div></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$index ||= 1;</td></tr>
<tr><td class="h">897</td><td><div class="c3">19</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $control = $inputs[ $index - 1 ];</td></tr>
<tr><td class="h">898</td><td><div class="c3">19</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L898">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;defined $value ? $control-&gt;value( $value ) : $control-&gt;value();</td></tr>
<tr><td class="h">899</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">900</td><td colspan="7"></td></tr><tr><td class="h">901 - 916</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;select( $name, $value )

=head2 $ie-&gt;select( $name, \@values )

Given the name of a C&lt;select&gt; field, set its value to the value
specified.&nbsp;&nbsp;If the field is not E&lt;lt&gt;select multipleE&lt;gt&gt; and the
C&lt;$value&gt; is an array, only the B&lt;first&gt; value will be set. Passing
C&lt;$value&gt; as a hash with an C&lt;n&gt; key selects an item by number
(e.g. C&lt;{n =&gt; 3&gt; or C&lt;{n =&gt; [2,4]}&gt;).&nbsp;&nbsp;The numbering starts at 1.
This applies to the current form (as set by the C&lt;L&lt;form()&gt;&gt; method or
defaulting to the first form on the page).

Returns 1 on successfully setting the value. On failure, returns
undef and calls C&lt;$self-&gt;warn()&gt; with an error message.

=cut</pre></td></tr>
<tr><td class="h">917</td><td colspan="7"></td></tr><tr><td class="h">918</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub select {</td></tr>
<tr><td class="h">919</td><td><div class="c3">10</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L919">10</a></div></td><td><div class="c3">1</div></td><td><div>3000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $self, $name, $value ) = @_;</td></tr>
<tr><td class="h">920</td><td colspan="7"></td></tr><tr><td class="h">921</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $form = $self-&gt;current_form;</td></tr>
<tr><td class="h">922</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $input = $form-&gt;find_input( $name, &#39;select&#39; );</td></tr>
<tr><td class="h">923</td><td><div class="c3">10</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L923">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( !$input ) {</td></tr>
<tr><td class="h">924</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;warn( &quot;Select &#39;$name&#39; not found.&quot; );</td></tr>
<tr><td class="h">925</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">926</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">927</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>2000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$input-&gt;select_value( $value );</td></tr>
<tr><td class="h">928</td><td><div class="c3">10</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">929</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">930</td><td colspan="7"></td></tr><tr><td class="h">931 - 948</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;set_fields( %arguments )

This method sets multiple fields of a form. It takes a list of field
name and value pairs. If there is more than one field with the same
name, the first one found is set. If you want to select which of the
duplicate field to set, use a value which is an anonymous array which
has the field value and its number as the 2 elements.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# set the second foo field
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;set_fields( $name =&gt; [ &#39;foo&#39;, 2 ] ) ;

The fields are numbered from 1.

This applies to the current form (as set by the C&lt;L&lt;form_name()&gt;&gt; or
C&lt;L&lt;form_number()&gt;&gt; method or defaulting to the first form on the
page).

=cut</pre></td></tr>
<tr><td class="h">949</td><td colspan="7"></td></tr><tr><td class="h">950</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_fields {</td></tr>
<tr><td class="h">951</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L951">1</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">952</td><td colspan="7"></td></tr><tr><td class="h">953</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $form = $self-&gt;current_form;</td></tr>
<tr><td class="h">954</td><td><div class="c3">1</div><div class="c0">0</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L954">50</a></div><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L954">50</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %opt = @_ ? UNIVERSAL::isa( $_[0], &#39;HASH&#39; ) ? %{ $_[0] } : @_ : ();</td></tr>
<tr><td class="h">955</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while ( my( $fname, $value ) = each %opt ) {</td></tr>
<tr><td class="h">956</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L956">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ref $value eq &#39;ARRAY&#39; ) {</td></tr>
<tr><td class="h">957</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my( $input ) = $form-&gt;find_input( $fname, undef, $value-&gt;[1] );</td></tr>
<tr><td class="h">958</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L958">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $input ) {</td></tr>
<tr><td class="h">959</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input-&gt;value( $value-&gt;[0] );</td></tr>
<tr><td class="h">960</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">961</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;warn( &quot;No inputcontrol by the name &#39;$fname&#39;&quot; );</td></tr>
<tr><td class="h">962</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">963</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">964</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my( $input ) = $form-&gt;find_input( $fname );</td></tr>
<tr><td class="h">965</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L965">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $input ) {</td></tr>
<tr><td class="h">966</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input-&gt;value( $value );</td></tr>
<tr><td class="h">967</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">968</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sssself-&gt;warn( &quot;No inputcontrol by the name &#39;$fname&#39;&quot; );</td></tr>
<tr><td class="h">969</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">970</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">971</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">972</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">973</td><td colspan="7"></td></tr><tr><td class="h">974 - 1010</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;set_visible( @criteria )

This method sets fields of a form without having to know their
names.&nbsp;&nbsp;So if you have a login screen that wants a username and
password, you do not have to fetch the form and inspect the source
to see what the field names are; you can just say

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;set_visible( $username, $password ) ;

and the first and second fields will be set accordingly.&nbsp;&nbsp;The method
is called set_I&lt;visible&gt; because it acts only on visible fields;
hidden form inputs are not considered.&nbsp;&nbsp;The order of the fields is
the order in which they appear in the HTML source which is nearly
always the order anyone viewing the page would think they are in,
but some creative work with tables could change that; caveat user.

Each element in C&lt;@criteria&gt; is either a field value or a field
specifier.&nbsp;&nbsp;A field value is a scalar.&nbsp;&nbsp;A field specifier allows
you to specify the I&lt;type&gt; of input field you want to set and is
denoted with an arrayref containing two elements.&nbsp;&nbsp;So you could
specify the first radio button with

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;set_visible( [ radio =&gt; &quot;KCRW&quot; ] ) ;

Field values and specifiers can be intermixed, hence

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;set_visible( &quot;fred&quot;, &quot;secret&quot;, [ select =&gt; &quot;Checking&quot; ] ) ;

would set the first two fields to &quot;fred&quot; and &quot;secret&quot;, and the I&lt;next&gt;
C&lt;OPTION&gt; menu field to &quot;Checking&quot;.

The possible field specifier types are: &quot;text&quot;, &quot;password&quot;, &quot;hidden&quot;,
&quot;textarea&quot;, &quot;file&quot;, &quot;image&quot;, &quot;submit&quot;, &quot;radio&quot;, &quot;checkbox&quot; and &quot;select&quot;.

This method was ported from L&lt;WWW::Mechanize&gt;.

=cut</pre></td></tr>
<tr><td class="h">1011</td><td colspan="7"></td></tr><tr><td class="h">1012</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_visible {</td></tr>
<tr><td class="h">1013</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1013">2</a></div></td><td><div class="c3">1</div></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1014</td><td colspan="7"></td></tr><tr><td class="h">1015</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $form = $self-&gt;current_form;</td></tr>
<tr><td class="h">1016</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @inputs = $form-&gt;inputs;</td></tr>
<tr><td class="h">1017</td><td colspan="7"></td></tr><tr><td class="h">1018</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (my $value = shift) {</td></tr>
<tr><td class="h">1019</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1019">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ref $value eq &#39;ARRAY&#39; ) {</td></tr>
<tr><td class="h">1020</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ( $type, $val ) = @$value;</td></tr>
<tr><td class="h">1021</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ( my $input = shift @inputs ) {</td></tr>
<tr><td class="h">1022</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1022">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $input-&gt;type eq &#39;hidden&#39;;</td></tr>
<tr><td class="h">1023</td><td><div class="c3">3</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1023">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $input-&gt;type eq $type ) {</td></tr>
<tr><td class="h">1024</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input-&gt;value( $val );</td></tr>
<tr><td class="h">1025</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">1026</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1027</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} # while</td></tr>
<tr><td class="h">1028</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">1029</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ( my $input = shift @inputs ) {</td></tr>
<tr><td class="h">1030</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1030">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $input-&gt;type eq &#39;hidden&#39;;</td></tr>
<tr><td class="h">1031</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$input-&gt;value( $value );</td></tr>
<tr><td class="h">1032</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last;</td></tr>
<tr><td class="h">1033</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} # while</td></tr>
<tr><td class="h">1034</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1035</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} # while</td></tr>
<tr><td class="h">1036</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1037</td><td colspan="7"></td></tr><tr><td class="h">1038 - 1045</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;tick( $name, $value[, $set] )

&#39;Ticks&#39; the first checkbox that has both the name and value assoicated
with it on the current form.&nbsp;&nbsp;Dies if there is no named check box for
that value.&nbsp;&nbsp;Passing in a false value as the third optional argument
will cause the checkbox to be unticked.

=cut</pre></td></tr>
<tr><td class="h">1046</td><td colspan="7"></td></tr><tr><td class="h">1047</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub tick {</td></tr>
<tr><td class="h">1048</td><td><div class="c3">7</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1048">7</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $self, $name, $value, $set ) = @_;</td></tr>
<tr><td class="h">1049</td><td colspan="7"></td></tr><tr><td class="h">1050</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $form = $self-&gt;current_form;</td></tr>
<tr><td class="h">1051</td><td><div class="c3">7</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1051">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$set = 1 if @_ &lt;= 3;</td></tr>
<tr><td class="h">1052</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @check_boxes = grep $_-&gt;value eq $value</td></tr>
<tr><td class="h">1053</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt; $form-&gt;find_input( $name, &#39;checkbox&#39; );</td></tr>
<tr><td class="h">1054</td><td colspan="7"></td></tr><tr><td class="h">1055</td><td><div class="c3">7</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1055">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;warn( &quot;No checkbox &#39;$name&#39;&nbsp;&nbsp;for value &#39;$value&#39; in form.&quot; ), return</td></tr>
<tr><td class="h">1056</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless @check_boxes;</td></tr>
<tr><td class="h">1057</td><td colspan="7"></td></tr><tr><td class="h">1058</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $check_box ( @check_boxes ) {</td></tr>
<tr><td class="h">1059</td><td><div class="c3">7</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1059">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next unless $check_box-&gt;value eq $value;</td></tr>
<tr><td class="h">1060</td><td><div class="c3">7</div><div class="c3">7</div></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L1060">100</a></div></td><td></td><td></td><td><div>1000</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${$check_box}-&gt;{checked} = $set || 0;</td></tr>
<tr><td class="h">1061</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1062</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1;</td></tr>
<tr><td class="h">1063</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1064</td><td colspan="7"></td></tr><tr><td class="h">1065 - 1070</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;untick( $name, $value )

Causes the checkbox to be unticked. Shorthand for
C&lt;tick( $name, $value, undef)&gt;

=cut</pre></td></tr>
<tr><td class="h">1071</td><td colspan="7"></td></tr><tr><td class="h">1072</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub untick {</td></tr>
<tr><td class="h">1073</td><td><div class="c3">3</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1073">3</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1074</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;tick( @_[0, 1], undef );</td></tr>
<tr><td class="h">1075</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1076</td><td colspan="7"></td></tr><tr><td class="h">1077 - 1090</td><td colspan="6"></td><td class="s"><pre>=head2 $mech-&gt;value( $name, $number )

Given the name of a field, return its value. This applies to the current
form (as set by the C&lt;form()&gt; method or defaulting to the first form on
the page).

The option I&lt;$number&gt; parameter is used to distinguish between two fields
with the same name.&nbsp;&nbsp;The fields are numbered from 1.

If the field is of type file (file upload field), the value is always
cleared to prevent remote sites from downloading your local files.
To upload a file, specify its file name explicitly.

=cut</pre></td></tr>
<tr><td class="h">1091</td><td colspan="7"></td></tr><tr><td class="h">1092</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub value {</td></tr>
<tr><td class="h">1093</td><td><div class="c3">5</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1093">5</a></div></td><td><div class="c3">1</div></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1094</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">1095</td><td><div class="c3">5</div></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L1095">50</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $number = shift || 1;</td></tr>
<tr><td class="h">1096</td><td colspan="7"></td></tr><tr><td class="h">1097</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $form = $self-&gt;current_form;</td></tr>
<tr><td class="h">1098</td><td><div class="c3">5</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1098">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( wantarray ) {</td></tr>
<tr><td class="h">1099</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @inputs = $form-&gt;find_input( $name );</td></tr>
<tr><td class="h">1100</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1100">50</a></div></td><td></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return @inputs ? map $_-&gt;value() =&gt; @inputs : undef;</td></tr>
<tr><td class="h">1101</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1102</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1102">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $number &gt; 1 ) {</td></tr>
<tr><td class="h">1103</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $form-&gt;find_input( $name, undef, $number )-&gt;value();</td></tr>
<tr><td class="h">1104</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">1105</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $form-&gt;value( $name );</td></tr>
<tr><td class="h">1106</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1107</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1108</td><td colspan="7"></td></tr><tr><td class="h">1109 - 1116</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;click( $button )

Call the click method on an INPUT object with the name C&lt;$button&gt; Has
the effect of clicking a button on a form.&nbsp;&nbsp;The first argument is the
name of the button to be clicked. I have not found a way to set the
(x,y) coordinates of the click in IE.

=cut</pre></td></tr>
<tr><td class="h">1117</td><td colspan="7"></td></tr><tr><td class="h">1118</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub click {</td></tr>
<tr><td class="h">1119</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1119">1</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $self, $button ) = @_;</td></tr>
<tr><td class="h">1120</td><td colspan="7"></td></tr><tr><td class="h">1121</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $form = $self-&gt;current_form;</td></tr>
<tr><td class="h">1122</td><td colspan="7"></td></tr><tr><td class="h">1123</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $toclick ) = sort { </td></tr>
<tr><td class="h">1124</td><td><div class="c3">1</div><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${$a}-&gt;{sourceIndex} &lt;=&gt; ${$b}-&gt;{sourceIndex} </td></tr>
<tr><td class="h">1125</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} $form-&gt;find_input( $button, &#39;button&#39; ),</td></tr>
<tr><td class="h">1126</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$form-&gt;find_input( $button, &#39;image&#39; ),</td></tr>
<tr><td class="h">1127</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$form-&gt;find_input( $button, &#39;submit&#39; );</td></tr>
<tr><td class="h">1128</td><td colspan="7"></td></tr><tr><td class="h">1129</td><td><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1129">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$toclick and $toclick-&gt;click;</td></tr>
<tr><td class="h">1130</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>6000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_wait_while_busy;</td></tr>
<tr><td class="h">1131</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1132</td><td colspan="7"></td></tr><tr><td class="h">1133 - 1159</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;click_button( %args )

Has the effect of clicking a button on a form by specifying its name,
value, or index.&nbsp;&nbsp;Its arguments are a list of key/value pairs.&nbsp;&nbsp;Only
one of name, number, or value must be specified.

=over 4

=item * name =&gt; name

Clicks the button named I&lt;name&gt;.

=item * number =&gt; n

Clicks the I&lt;n&gt;th button in the form.

=item * value =&gt; value

Clicks the button with the value I&lt;value&gt;.

=back

B&lt;NOTE&gt;: Unlike WWW::Mechanize, Win32::IE::Mechanize takes
all buttonish types of C&lt;&lt; &lt;INPUT type=&gt; &gt;&gt; into accout: B&lt;button&gt;,
B&lt;image&gt; and B&lt;submit&gt;.

=cut</pre></td></tr>
<tr><td class="h">1160</td><td colspan="7"></td></tr><tr><td class="h">1161</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub click_button {</td></tr>
<tr><td class="h">1162</td><td><div class="c3">7</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1162">7</a></div></td><td><div class="c3">1</div></td><td><div>7002</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1163</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %args = @_;</td></tr>
<tr><td class="h">1164</td><td colspan="7"></td></tr><tr><td class="h">1165</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for ( keys %args ) {</td></tr>
<tr><td class="h">1166</td><td><div class="c3">7</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1166">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( !/^(number|name|value)$/ ) {</td></tr>
<tr><td class="h">1167</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;warn( qq{Unknown click_button_form parameter &quot;$_&quot;} );</td></tr>
<tr><td class="h">1168</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1169</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1170</td><td colspan="7"></td></tr><tr><td class="h">1171</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $form = $self-&gt;current_form;</td></tr>
<tr><td class="h">1172</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @buttons = sort { </td></tr>
<tr><td class="h">1173</td><td><div class="c3">7</div><div class="c3">28</div><div class="c3">28</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>3001</div><div>3000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${$a}-&gt;{sourceIndex} &lt;=&gt; ${$b}-&gt;{sourceIndex} </td></tr>
<tr><td class="h">1174</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} $form-&gt;find_input( $args{name}, &#39;button&#39; ),</td></tr>
<tr><td class="h">1175</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$form-&gt;find_input( $args{name}, &#39;image&#39; ),</td></tr>
<tr><td class="h">1176</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$form-&gt;find_input( $args{name}, &#39;submit&#39; );</td></tr>
<tr><td class="h">1177</td><td colspan="7"></td></tr><tr><td class="h">1178</td><td><div class="c3">7</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1178">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@buttons or return;</td></tr>
<tr><td class="h">1179</td><td><div class="c3">7</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1179">50</a></div><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1179">50</a></div><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1179">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $args{name} ) {</td></tr>
<tr><td class="h">1180</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$buttons[0]-&gt;click;</td></tr>
<tr><td class="h">1181</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;_wait_while_busy;</td></tr>
<tr><td class="h">1182</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} elsif ( $args{number} ) {</td></tr>
<tr><td class="h">1183</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1183">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@buttons &lt;= $args{number} and return</td></tr>
<tr><td class="h">1184</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$buttons[ $args{number} - 1 ]-&gt;click();</td></tr>
<tr><td class="h">1185</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;_wait_while_busy;</td></tr>
<tr><td class="h">1186</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} elsif ( $args{value} ) {</td></tr>
<tr><td class="h">1187</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $button ( @buttons ) {</td></tr>
<tr><td class="h">1188</td><td><div class="c3">22</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1188">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $button-&gt;value eq $args{value} ) {</td></tr>
<tr><td class="h">1189</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>3000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$button-&gt;click();</td></tr>
<tr><td class="h">1190</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td></td><td><div>11002</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;_wait_while_busy;</td></tr>
<tr><td class="h">1191</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1192</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1193</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1194</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1195</td><td colspan="7"></td></tr><tr><td class="h">1196 - 1207</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;submit( )

Submits the page, without specifying a button to click.&nbsp;&nbsp;Actually,
no button is clicked at all.

This will call the C&lt;Submit()&gt; method of the currently selected form.

B&lt;NOTE&gt;: It looks like this method does not call the C&lt;onSubmit&gt;
handler specified in the C&lt;&lt; &lt;FORM&gt; &gt;&gt;-tag, that only seems to work if
you call the C&lt;click_button()&gt; method with submit button.

=cut</pre></td></tr>
<tr><td class="h">1208</td><td colspan="7"></td></tr><tr><td class="h">1209</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub submit {</td></tr>
<tr><td class="h">1210</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1210">2</a></div></td><td><div class="c3">1</div></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1211</td><td colspan="7"></td></tr><tr><td class="h">1212</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $form = $self-&gt;current_form;</td></tr>
<tr><td class="h">1213</td><td colspan="7"></td></tr><tr><td class="h">1214</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$form-&gt;submit;</td></tr>
<tr><td class="h">1215</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>13002</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;_wait_while_busy;</td></tr>
<tr><td class="h">1216</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1217</td><td colspan="7"></td></tr><tr><td class="h">1218 - 1256</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;submit_form( %opt )

This method lets you select a form from the previously fetched page,
fill in its fields, and submit it. It combines the form_number/form_name,
set_fields and click methods into one higher level call. Its arguments
are a list of key/value pairs, all of which are optional.

=over 4

=item * form_number =&gt; n

Selects the I&lt;n&gt;th form (calls C&lt;L&lt;form_number()&gt;&gt;).&nbsp;&nbsp;If this parm is not
specified, the currently-selected form is used.

=item * form_name =&gt; name

Selects the form named I&lt;name&gt; (calls C&lt;L&lt;form_name()&gt;&gt;)

=item * fields =&gt; fields

Sets the field values from the I&lt;fields&gt; hashref (calls C&lt;L&lt;set_fields()&gt;&gt;)

=item * button =&gt; button

Clicks on button I&lt;button&gt; (calls C&lt;L&lt;click()&gt;&gt;)

=item * button =&gt; { value =&gt; value }

When you specify a hash_ref for button it calls C&lt;click_button()&gt;

=back

If no form is selected, the first form found is used.

If I&lt;button&gt; is not passed, then the C&lt;L&lt;submit()&gt;&gt; method is used instead.

Returns true on success.

=cut</pre></td></tr>
<tr><td class="h">1257</td><td colspan="7"></td></tr><tr><td class="h">1258</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub submit_form {</td></tr>
<tr><td class="h">1259</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1259">1</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1260</td><td colspan="7"></td></tr><tr><td class="h">1261</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %opt = @_;</td></tr>
<tr><td class="h">1262</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1262">50</a></div><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1262">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( my $form_number = $opt{form_number} ) {</td></tr>
<tr><td class="h">1263</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;form_number( $form_number ) ;</td></tr>
<tr><td class="h">1264</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1265</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;elsif ( my $form_name = $opt{form_name} ) {</td></tr>
<tr><td class="h">1266</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;form_name( $form_name ) ;</td></tr>
<tr><td class="h">1267</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">1268</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1268">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;form_number( 1 ) unless defined $self-&gt;{cur_form};</td></tr>
<tr><td class="h">1269</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1270</td><td colspan="7"></td></tr><tr><td class="h">1271</td><td><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1271">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( my $fields = $opt{fields} ) {</td></tr>
<tr><td class="h">1272</td><td><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1272">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ref $fields eq &#39;HASH&#39; ) {</td></tr>
<tr><td class="h">1273</td><td><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;set_fields( %{$fields} ) ;</td></tr>
<tr><td class="h">1274</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} # TODO: What if it&#39;s not a hash?&nbsp;&nbsp;We just ignore it silently?</td></tr>
<tr><td class="h">1275</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1276</td><td colspan="7"></td></tr><tr><td class="h">1277</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1277">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $opt{button} ) {</td></tr>
<tr><td class="h">1278</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1278">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ref $opt{button} ) {</td></tr>
<tr><td class="h">1279</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;click_button( %{ $opt{button} } );</td></tr>
<tr><td class="h">1280</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">1281</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;click( $opt{button} );</td></tr>
<tr><td class="h">1282</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1283</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">1284</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;submit();</td></tr>
<tr><td class="h">1285</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1286</td><td colspan="7"></td></tr><tr><td class="h">1287</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;success;</td></tr>
<tr><td class="h">1288</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1289</td><td colspan="7"></td></tr><tr><td class="h">1290 - 1305</td><td colspan="6"></td><td class="s"><pre>=head1 MISCELANEOUS METHODS

=head2 $ie-&gt;add_header( name =&gt; $value [, name =&gt; $value... ] )

Sets HTTP headers for the agent to add or remove from the HTTP request.

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;add_header( Encoding =&gt; &#39;text/klingon&#39; );

If a I&lt;value&gt; is C&lt;undef&gt;, then that header will be removed from any
future requests.&nbsp;&nbsp;For example, to never send a Referer header:

&nbsp;&nbsp;&nbsp;&nbsp;$ie-&gt;add_header( Referer =&gt; undef );

Returns the number of name/value pairs added.

=cut</pre></td></tr>
<tr><td class="h">1306</td><td colspan="7"></td></tr><tr><td class="h">1307</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub add_header {</td></tr>
<tr><td class="h">1308</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1308">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1309</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $npairs = 0;</td></tr>
<tr><td class="h">1310</td><td colspan="7"></td></tr><tr><td class="h">1311</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while ( @_ ) {</td></tr>
<tr><td class="h">1312</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key = shift;</td></tr>
<tr><td class="h">1313</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $value = shift;</td></tr>
<tr><td class="h">1314</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++$npairs;</td></tr>
<tr><td class="h">1315</td><td colspan="7"></td></tr><tr><td class="h">1316</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{headers}{$key} = $value;</td></tr>
<tr><td class="h">1317</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1318</td><td colspan="7"></td></tr><tr><td class="h">1319</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $npairs;</td></tr>
<tr><td class="h">1320</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1321</td><td colspan="7"></td></tr><tr><td class="h">1322 - 1328</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;delete_header( name [, name ... ] )

Removes HTTP headers from the agent&#39;s list of special headers.

B&lt;NOTE&gt;: This might not work like it does with C&lt;WWW::Mechanize&gt;

=cut</pre></td></tr>
<tr><td class="h">1329</td><td colspan="7"></td></tr><tr><td class="h">1330</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub delete_header {</td></tr>
<tr><td class="h">1331</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1331">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1332</td><td colspan="7"></td></tr><tr><td class="h">1333</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while ( @_ ) {</td></tr>
<tr><td class="h">1334</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key = shift;</td></tr>
<tr><td class="h">1335</td><td colspan="7"></td></tr><tr><td class="h">1336</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $self-&gt;{headers}{$key};</td></tr>
<tr><td class="h">1337</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1338</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1339</td><td colspan="7"></td></tr><tr><td class="h">1340 - 1348</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;quiet( [$state] )

Allows you to suppress warnings to the screen.

&nbsp;&nbsp;&nbsp;&nbsp;$a-&gt;quiet(0); # turns on warnings (the default)
&nbsp;&nbsp;&nbsp;&nbsp;$a-&gt;quiet(1); # turns off warnings
&nbsp;&nbsp;&nbsp;&nbsp;$a-&gt;quiet();&nbsp;&nbsp;# returns the current quietness status

=cut</pre></td></tr>
<tr><td class="h">1349</td><td colspan="7"></td></tr><tr><td class="h">1350</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub quiet {</td></tr>
<tr><td class="h">1351</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1351">2</a></div></td><td><div class="c3">1</div></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1352</td><td colspan="7"></td></tr><tr><td class="h">1353</td><td><div class="c3">2</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1353">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{quiet} = $_[0] if @_;</td></tr>
<tr><td class="h">1354</td><td colspan="7"></td></tr><tr><td class="h">1355</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;{quiet};</td></tr>
<tr><td class="h">1356</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1357</td><td colspan="7"></td></tr><tr><td class="h">1358 - 1362</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;find_frame( $frame_name )

Returns the URL to the source of the frame with C&lt;name eq $frame_name&gt;

=cut</pre></td></tr>
<tr><td class="h">1363</td><td colspan="7"></td></tr><tr><td class="h">1364</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find_frame {</td></tr>
<tr><td class="h">1365</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1365">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $self, $frame ) = @_;</td></tr>
<tr><td class="h">1366</td><td colspan="7"></td></tr><tr><td class="h">1367</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $agent = $self-&gt;{agent};</td></tr>
<tr><td class="h">1368</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $doc = $agent-&gt;Document;</td></tr>
<tr><td class="h">1369</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for ( my $i = 0; $i &lt; $doc-&gt;all-&gt;length; $i++ ) {</td></tr>
<tr><td class="h">1370</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj = $doc-&gt;all( $i );</td></tr>
<tr><td class="h">1371</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1371">0</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L1371">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next unless $obj &amp;&amp; $obj-&gt;tagName &amp;&amp;</td></tr>
<tr><td class="h">1372</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;tagName eq &#39;FRAME&#39; &amp;&amp;</td></tr>
<tr><td class="h">1373</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$obj-&gt;name&nbsp;&nbsp;&nbsp;&nbsp;eq $frame;</td></tr>
<tr><td class="h">1374</td><td colspan="7"></td></tr><tr><td class="h">1375</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return ( URI-&gt;new_abs( $obj-&gt;src, $doc-&gt;URL ) )-&gt;as_string;</td></tr>
<tr><td class="h">1376</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1377</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1378</td><td colspan="7"></td></tr><tr><td class="h">1379 - 1383</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;load_frame( $frame_name )

C&lt;&lt; $self-&gt;get( $self-&gt;find_frame( $frame_name )) &gt;&gt;

=cut</pre></td></tr>
<tr><td class="h">1384</td><td colspan="7"></td></tr><tr><td class="h">1385</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub load_frame {</td></tr>
<tr><td class="h">1386</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1386">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $self, $frame ) = @_;</td></tr>
<tr><td class="h">1387</td><td colspan="7"></td></tr><tr><td class="h">1388</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;get( $self-&gt;find_frame( $frame ) );</td></tr>
<tr><td class="h">1389</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1390</td><td colspan="7"></td></tr><tr><td class="h">1391 - 1399</td><td colspan="6"></td><td class="s"><pre>=head1 LWP COMPATABILITY METHODS

=head2 $ie-&gt;credentials( $netloc, $realm, $uid, $pass )

Set the user name and password to be used for a realm.

C&lt;$netloc&gt; looks like C&lt;hostname:port&gt;.

=cut</pre></td></tr>
<tr><td class="h">1400</td><td colspan="7"></td></tr><tr><td class="h">1401</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub credentials {</td></tr>
<tr><td class="h">1402</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1402">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my($self, $netloc, $realm, $uid, $pass) = @_;</td></tr>
<tr><td class="h">1403</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{basic_authentication}{ $netloc }{ $realm } = [ $uid, $pass ];</td></tr>
<tr><td class="h">1404</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{basic_authentication}{ $netloc }{__active_realm__} = $realm;</td></tr>
<tr><td class="h">1405</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1406</td><td colspan="7"></td></tr><tr><td class="h">1407 - 1419</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;get_basic_credentials( $realm, $uri )

This is called by C&lt;_extra_headers&gt; to retrieve credentials for documents
protected by Basic Authentication.&nbsp;&nbsp;The arguments passed in
are the C&lt;$realm&gt; and the C&lt;$uri&gt; requested.

The method should return a username and password.&nbsp;&nbsp;It should return an
empty list to abort the authentication resolution attempt.

The base implementation simply checks a set of pre-stored member
variables, set up with the credentials() method.

=cut</pre></td></tr>
<tr><td class="h">1420</td><td colspan="7"></td></tr><tr><td class="h">1421</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_basic_credentials {</td></tr>
<tr><td class="h">1422</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1422">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my($self, $realm, $uri ) = @_;</td></tr>
<tr><td class="h">1423</td><td colspan="7"></td></tr><tr><td class="h">1424</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1424">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $host_port = $uri-&gt;can( &#39;host_port&#39; )</td></tr>
<tr><td class="h">1425</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $uri-&gt;host_port : $uri-&gt;as_string;</td></tr>
<tr><td class="h">1426</td><td colspan="7"></td></tr><tr><td class="h">1427</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L1427">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$realm ||= $self-&gt;{basic_authentication}{ $host_port }{__active_realm__};</td></tr>
<tr><td class="h">1428</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1428">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$realm or return ( );</td></tr>
<tr><td class="h">1429</td><td colspan="7"></td></tr><tr><td class="h">1430</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1430">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( exists $self-&gt;{basic_authentication}{ $host_port }{ $realm } ) {</td></tr>
<tr><td class="h">1431</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return @{ $self-&gt;{basic_authentication}{ $host_port }{ $realm } };</td></tr>
<tr><td class="h">1432</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1433</td><td colspan="7"></td></tr><tr><td class="h">1434</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ( );</td></tr>
<tr><td class="h">1435</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1436</td><td colspan="7"></td></tr><tr><td class="h">1437 - 1448</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;set_realm( $netloc, $realm );

Sets the authentication realm to C&lt;$realm&gt; for C&lt;$netloc&gt;. An empty value
unsets the realm for C&lt;$netloc&gt;.

C&lt;$netloc&gt; looks like C&lt;hostname:port&gt;.

As I have not found a way to access response-headers, I cannot find
out the authentication realm (if any) and automagically set the right
headers. You will have to do some bookkeeping for now.

=cut</pre></td></tr>
<tr><td class="h">1449</td><td colspan="7"></td></tr><tr><td class="h">1450</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub set_realm {</td></tr>
<tr><td class="h">1451</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1451">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $self, $netloc, $realm ) = @_;</td></tr>
<tr><td class="h">1452</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1452">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$netloc or return;</td></tr>
<tr><td class="h">1453</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1453">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;defined $realm or $realm = &quot;&quot;;</td></tr>
<tr><td class="h">1454</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{basic_authentication}{ $netloc }{__active_realm__} = $realm;</td></tr>
<tr><td class="h">1455</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1456</td><td colspan="7"></td></tr><tr><td class="h">1457 - 1463</td><td colspan="6"></td><td class="s"><pre>=head1 INTERNAL-ONLY METHODS

=head2 DESTROY

We need to close the IE-instance, at least when not visible!

=cut</pre></td></tr>
<tr><td class="h">1464</td><td colspan="7"></td></tr><tr><td class="h">1465</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub DESTROY {</td></tr>
<tr><td class="h">1466</td><td><div class="c3">16</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1466">16</a></div></td><td></td><td><div>15000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $agent = shift-&gt;{agent};</td></tr>
<tr><td class="h">1467</td><td><div class="c3">16</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1467">100</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L1467">67</a></div></td><td></td><td></td><td><div>1001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$agent &amp;&amp; !$agent-&gt;{visible} and $agent-&gt;quit;</td></tr>
<tr><td class="h">1468</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1469</td><td colspan="7"></td></tr><tr><td class="h">1470 - 1476</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;_extract_forms()

Return a list of forms using the C&lt;&lt; $ie-&gt;Document-&gt;forms &gt;&gt;
interface. All forms are mapped onto the L&lt;Win32::IE::Form&gt; interface
that mimics L&lt;HTML::Form&gt;.

=cut</pre></td></tr>
<tr><td class="h">1477</td><td colspan="7"></td></tr><tr><td class="h">1478</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _extract_forms {</td></tr>
<tr><td class="h">1479</td><td><div class="c3">12</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1479">12</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1480</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $doc = $self-&gt;{agent}-&gt;Document;</td></tr>
<tr><td class="h">1481</td><td colspan="7"></td></tr><tr><td class="h">1482</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @forms;</td></tr>
<tr><td class="h">1483</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for ( my $i = 0; $i &lt; $doc-&gt;forms-&gt;length; $i++ ) {</td></tr>
<tr><td class="h">1484</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td></td><td><div>7001</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @forms, __new_form( $doc-&gt;forms( $i ) );</td></tr>
<tr><td class="h">1485</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1486</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td></td><td><div>9002</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{forms} = \@forms;</td></tr>
<tr><td class="h">1487</td><td colspan="7"></td></tr><tr><td class="h">1488</td><td><div class="c3">12</div><div class="c0">0</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1488">50</a></div></td><td></td><td></td><td></td><td><div>2000</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return wantarray ? @{ $self-&gt;{forms} } : $self-&gt;{forms};</td></tr>
<tr><td class="h">1489</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1490</td><td colspan="7"></td></tr><tr><td class="h">1491 - 1507</td><td colspan="6"></td><td class="s"><pre>=head2 $self-&gt;_extract_links()

The links come from the following:

=over 2

=item &quot;&lt;A HREF=...&gt;&quot;

=item &quot;&lt;AREA HREF=...&gt;&quot;

=item &quot;&lt;FRAME SRC=...&gt;&quot;

=item &quot;&lt;IFRAME SRC=...&gt;&quot;

=back

=cut</pre></td></tr>
<tr><td class="h">1508</td><td colspan="7"></td></tr><tr><td class="h">1509</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _extract_links {</td></tr>
<tr><td class="h">1510</td><td><div class="c3">5</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1510">5</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1511</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $doc = $self-&gt;{agent}-&gt;Document;</td></tr>
<tr><td class="h">1512</td><td colspan="7"></td></tr><tr><td class="h">1513</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @links;</td></tr>
<tr><td class="h">1514</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for ( my $i = 0; $i &lt; $doc-&gt;all-&gt;length; $i++ ) {</td></tr>
<tr><td class="h">1515</td><td><div class="c3">69</div></td><td></td><td></td><td></td><td></td><td><div>26004</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj = $doc-&gt;all( $i );</td></tr>
<tr><td class="h">1516</td><td><div class="c3">69</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1516">100</a></div></td><td></td><td></td><td></td><td><div>7000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next unless $obj-&gt;tagName =~ /^(?:IFRAME|FRAME|AREA|A)$/i;</td></tr>
<tr><td class="h">1517</td><td><div class="c3">21</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1517">50</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L1517">67</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if lc $obj-&gt;tagName eq &#39;a&#39; &amp;&amp; !$obj-&gt;href;</td></tr>
<tr><td class="h">1518</td><td><div class="c3">21</div></td><td></td><td></td><td></td><td></td><td><div>5000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @links, __new_link( $doc-&gt;all( $i ) );</td></tr>
<tr><td class="h">1519</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1520</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td></td><td><div>2000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{links} = \@links;</td></tr>
<tr><td class="h">1521</td><td colspan="7"></td></tr><tr><td class="h">1522</td><td><div class="c3">5</div><div class="c0">0</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1522">50</a></div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return wantarray ? @{ $self-&gt;{links} } : $self-&gt;{links};</td></tr>
<tr><td class="h">1523</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1524</td><td colspan="7"></td></tr><tr><td class="h">1525 - 1531</td><td colspan="6"></td><td class="s"><pre>=head2 $ie-&gt;_extract_images()

Return a list of images using the C&lt;&lt; $ie-&gt;Document-&gt;images &gt;&gt;
interface. All images are mapped onto the L&lt;Win32::IE::Image&gt; interface
that mimics L&lt;WWW::Mechanize::Images&gt;.

=cut</pre></td></tr>
<tr><td class="h">1532</td><td colspan="7"></td></tr><tr><td class="h">1533</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _extract_images {</td></tr>
<tr><td class="h">1534</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1534">1</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1535</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $doc = $self-&gt;{agent}-&gt;Document;</td></tr>
<tr><td class="h">1536</td><td colspan="7"></td></tr><tr><td class="h">1537</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @images;</td></tr>
<tr><td class="h">1538</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for ( my $i = 0; $i &lt; $doc-&gt;all-&gt;length; $i++ ) {</td></tr>
<tr><td class="h">1539</td><td><div class="c3">15</div></td><td></td><td></td><td></td><td></td><td><div>32004</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $obj = $doc-&gt;all( $i );</td></tr>
<tr><td class="h">1540</td><td><div class="c3">15</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1540">100</a></div><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1540">100</a></div></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L1540">100</a></div><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L1540">100</a></div></td><td></td><td></td><td><div>3000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $obj-&gt;tagName eq &#39;IMG&#39; ) {</td></tr>
<tr><td class="h">1541</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @images, __new_image( $doc-&gt;all( $i ) );</td></tr>
<tr><td class="h">1542</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elsif ( $obj-&gt;tagName eq &#39;INPUT&#39; &amp;&amp;</td></tr>
<tr><td class="h">1543</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grep /src/i &amp;&amp; $obj-&gt;{src} =&gt; keys %$obj ) {</td></tr>
<tr><td class="h">1544</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>25002</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @images, __new_image( $doc-&gt;all( $i ) );</td></tr>
<tr><td class="h">1545</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1546</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1547</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{images} = \@images;</td></tr>
<tr><td class="h">1548</td><td colspan="7"></td></tr><tr><td class="h">1549</td><td><div class="c3">1</div><div class="c0">0</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1549">50</a></div></td><td></td><td></td><td></td><td><div>1000</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return wantarray ? @{ $self-&gt;{forms} } : $self-&gt;{forms};</td></tr>
<tr><td class="h">1550</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1551</td><td colspan="7"></td></tr><tr><td class="h">1552 - 1557</td><td colspan="6"></td><td class="s"><pre>=head2 $self-&gt;_wait_while_busy()

This is still a mess, but we need to poll IE to see if it is ready
loading and displaying the page, before we can move on.

=cut</pre></td></tr>
<tr><td class="h">1558</td><td colspan="7"></td></tr><tr><td class="h">1559</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _wait_while_busy {</td></tr>
<tr><td class="h">1560</td><td><div class="c3">32</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1560">32</a></div></td><td></td><td><div>2000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1561</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $agent = $self-&gt;{agent};</td></tr>
<tr><td class="h">1562</td><td colspan="7"></td></tr><tr><td class="h">1563</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# The documentation isn&#39;t clear on this.</td></tr>
<tr><td class="h">1564</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# The DocumentComplete event roughly says:</td></tr>
<tr><td class="h">1565</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# the event gets fired (for each frame) after ReadyState == 4</td></tr>
<tr><td class="h">1566</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# we might need to check if the first one has frames</td></tr>
<tr><td class="h">1567</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# and do some more checking.</td></tr>
<tr><td class="h">1568</td><td colspan="7"></td></tr><tr><td class="h">1569</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;while ( $agent-&gt;{Busy} == 1 ) { $SLEEP and sleep( $SLEEP ) }</td></tr>
<tr><td class="h">1570</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">#&nbsp;&nbsp;&nbsp;&nbsp;return unless $agent-&gt;{ReadyState};</td></tr>
<tr><td class="h">1571</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while ( $agent-&gt;{ReadyState} &lt;= $READYSTATE ) {</td></tr>
<tr><td class="h">1572</td><td><div class="c3">6</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1572">50</a></div></td><td></td><td></td><td></td><td><div>335034</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$SLEEP and sleep( $SLEEP );</td></tr>
<tr><td class="h">1573</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1574</td><td colspan="7"></td></tr><tr><td class="h">1575</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>500050</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{ $_ } = undef for qw( forms cur_form links images );</td></tr>
<tr><td class="h">1576</td><td><div class="c3">32</div></td><td></td><td></td><td></td><td></td><td><div>1000</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;success;</td></tr>
<tr><td class="h">1577</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1578</td><td colspan="7"></td></tr><tr><td class="h">1579 - 1585</td><td colspan="6"></td><td class="s"><pre>=head2 warn( @messages )

Centralized warning method, for diagnostics and non-fatal problems.
Defaults to calling C&lt;CORE::warn&gt;, but may be overridden by setting
C&lt;onwarn&gt; in the construcotr.

=cut</pre></td></tr>
<tr><td class="h">1586</td><td colspan="7"></td></tr><tr><td class="h">1587</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub warn {</td></tr>
<tr><td class="h">1588</td><td><div class="c3">4</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1588">4</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1589</td><td colspan="7"></td></tr><tr><td class="h">1590</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1590">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless my $handler = $self-&gt;{onwarn};</td></tr>
<tr><td class="h">1591</td><td colspan="7"></td></tr><tr><td class="h">1592</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1592">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $self-&gt;quiet;</td></tr>
<tr><td class="h">1593</td><td colspan="7"></td></tr><tr><td class="h">1594</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$handler-&gt;(@_);</td></tr>
<tr><td class="h">1595</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1596</td><td colspan="7"></td></tr><tr><td class="h">1597 - 1602</td><td colspan="6"></td><td class="s"><pre>=head2 die( @messages )

Centralized error method.&nbsp;&nbsp;Defaults to calling C&lt;CORE::die&gt;, but
may be overridden by setting C&lt;onerror&gt; in the constructor.

=cut</pre></td></tr>
<tr><td class="h">1603</td><td colspan="7"></td></tr><tr><td class="h">1604</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub die {</td></tr>
<tr><td class="h">1605</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1605">0</a></div></td><td><div class="c3">1</div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">1606</td><td colspan="7"></td></tr><tr><td class="h">1607</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1607">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless my $handler = $self-&gt;{onerror};</td></tr>
<tr><td class="h">1608</td><td colspan="7"></td></tr><tr><td class="h">1609</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$handler-&gt;(@_);</td></tr>
<tr><td class="h">1610</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1611</td><td colspan="7"></td></tr><tr><td class="h">1612</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Not a method</td></tr>
<tr><td class="h">1613</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub __warn {</td></tr>
<tr><td class="h">1614</td><td colspan="7"></td></tr><tr><td class="h">1615</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1615">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;eval &quot;require Carp&quot;;</td></tr>
<tr><td class="h">1616</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1616">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ( $@ ) {</td></tr>
<tr><td class="h">1617</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CORE::warn @_;</td></tr>
<tr><td class="h">1618</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">1619</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;Carp::carp;</td></tr>
<tr><td class="h">1620</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1621</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1622</td><td colspan="7"></td></tr><tr><td class="h">1623</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s"># Not a method</td></tr>
<tr><td class="h">1624</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub __die {</td></tr>
<tr><td class="h">1625</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1625">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;require Carp;</td></tr>
<tr><td class="h">1626</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&amp;Carp::croak; # pass thru</td></tr>
<tr><td class="h">1627</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1628</td><td colspan="7"></td></tr><tr><td class="h">1629 - 1633</td><td colspan="6"></td><td class="s"><pre>=head2 $self-&gt;_extra_headers( )

For the moment we only support B&lt;basic authentication&gt;.

=cut</pre></td></tr>
<tr><td class="h">1634</td><td colspan="7"></td></tr><tr><td class="h">1635</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _extra_headers {</td></tr>
<tr><td class="h">1636</td><td><div class="c3">18</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1636">18</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $self, $uri ) = @_;</td></tr>
<tr><td class="h">1637</td><td colspan="7"></td></tr><tr><td class="h">1638</td><td><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $header = &quot;&quot;;</td></tr>
<tr><td class="h">1639</td><td colspan="7"></td></tr><tr><td class="h">1640</td><td><div class="c3">18</div><div class="c3">18</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;for my $header ( keys %{ $self-&gt;{headers} } ) {</td></tr>
<tr><td class="h">1641</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1641">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next unless defined $self-&gt;{headers}{ $header };</td></tr>
<tr><td class="h">1642</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( my $hfield = $header ) =~ s/(\w+)/ucfirst lc $1/eg;</td></tr>
<tr><td class="h">1643</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$header .= &quot;$hfield: $self-&gt;{headers}{ $header }\015\012&quot;;</td></tr>
<tr><td class="h">1644</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1645</td><td colspan="7"></td></tr><tr><td class="h">1646</td><td><div class="c3">18</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1646">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $host_port = $uri-&gt;can( &#39;host_port&#39; )</td></tr>
<tr><td class="h">1647</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;? $uri-&gt;host_port : $uri-&gt;as_string;</td></tr>
<tr><td class="h">1648</td><td><div class="c3">18</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1648">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $header unless exists $self-&gt;{basic_authentication}{ $host_port };</td></tr>
<tr><td class="h">1649</td><td colspan="7"></td></tr><tr><td class="h">1650</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $realm = $self-&gt;{basic_authentication}{ $host_port }{__active_realm__};</td></tr>
<tr><td class="h">1651</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $user, $pass ) = $self-&gt;get_basic_credentials( $realm, $uri );</td></tr>
<tr><td class="h">1652</td><td colspan="7"></td></tr><tr><td class="h">1653</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1653">0</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$header .= defined $user ? __authorization_basic( $user, $pass ) : &quot;&quot;;</td></tr>
<tr><td class="h">1654</td><td colspan="7"></td></tr><tr><td class="h">1655</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $header;</td></tr>
<tr><td class="h">1656</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1657</td><td colspan="7"></td></tr><tr><td class="h">1658 - 1665</td><td colspan="6"></td><td class="s"><pre>=head1 INTERNAL ONLY NON-METHODS

=head2 __prop_value( $key[, $value] )

Check to see if we support the property C&lt;$key&gt; and return a validated
value or the default value from C&lt;%ie_properties&gt;.

=cut</pre></td></tr>
<tr><td class="h">1666</td><td colspan="7"></td></tr><tr><td class="h">1667</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub __prop_value($;$) {</td></tr>
<tr><td class="h">1668</td><td><div class="c3">26</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1668">26</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $key, $value ) = @_;</td></tr>
<tr><td class="h">1669</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$key = lc $key;</td></tr>
<tr><td class="h">1670</td><td><div class="c3">26</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1670">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;exists $ie_property{ $key } or return undef;</td></tr>
<tr><td class="h">1671</td><td><div class="c3">26</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1671">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@_ &gt; 1 or return $ie_property{ $key }{value};</td></tr>
<tr><td class="h">1672</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;CASE: {</td></tr>
<tr><td class="h">1673</td><td><div class="c3">26</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local $_ = $ie_property{ $key }{type};</td></tr>
<tr><td class="h">1674</td><td colspan="7"></td></tr><tr><td class="h">1675</td><td><div class="c3">26</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1675">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/^b$/ and do {</td></tr>
<tr><td class="h">1676</td><td><div class="c3">18</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1676">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defined $value or return undef;</td></tr>
<tr><td class="h">1677</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1677">100</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $value ? 1 : 0;</td></tr>
<tr><td class="h">1678</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">1679</td><td><div class="c3">8</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1679">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/^n$/ and do {</td></tr>
<tr><td class="h">1680</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1680">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defined $value or return undef;</td></tr>
<tr><td class="h">1681</td><td><div class="c3">8</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1681">50</a></div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $value =~ /((?:\+|-)?[0-9]+)/ ? $1 : 0;</td></tr>
<tr><td class="h">1682</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">1683</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1684</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1685</td><td colspan="7"></td></tr><tr><td class="h">1686 - 1690</td><td colspan="6"></td><td class="s"><pre>=head2 __authorization_basic( $user, $pass )

Return a HTTP &quot;Authorization: Basic xxx&quot; header.

=cut</pre></td></tr>
<tr><td class="h">1691</td><td colspan="7"></td></tr><tr><td class="h">1692</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">sub __authorization_basic {</td></tr>
<tr><td class="h">1693</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1693">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $user, $pass ) = @_;</td></tr>
<tr><td class="h">1694</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Win32-IE-Mechanize-pm--branch.html#L1694">0</a></div></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--condition.html#L1694">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;defined $user &amp;&amp; defined $pass or return;</td></tr>
<tr><td class="h">1695</td><td colspan="7"></td></tr><tr><td class="h">1696</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;require MIME::Base64;</td></tr>
<tr><td class="h">1697</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &quot;Authorization: Basic &quot; .</td></tr>
<tr><td class="h">1698</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MIME::Base64::encode_base64( &quot;$user:$pass&quot; ) .</td></tr>
<tr><td class="h">1699</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\015\012&quot;;</td></tr>
<tr><td class="h">1700</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1701</td><td colspan="7"></td></tr><tr><td class="h">1702 - 1722</td><td colspan="6"></td><td class="s"><pre>=head1 ACCESS TO SUBPACKAGES

These subs just supply an interface to the Win32::IE::* sub objects.

=head2 __new_form( $form_obj )

Retuns a new Win32::IE::Form. NOT a method!

=head2 __new_input( $input_obj )

Retuns a new Win32::IE::Input. NOT a method!

=head2 __new_link( $link_obj )

Retuns a new Win32::IE::Link. NOT a method!

=head2 __new_image( $image_obj )

Retuns a new Win32::IE::Image. NOT a method!

=cut</pre></td></tr>
<tr><td class="h">1723</td><td colspan="7"></td></tr><tr><td class="h">1724</td><td><div class="c3">13</div><div class="c3">13</div><div class="c3">13</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1724">13</a></div></td><td></td><td><div>43003</div><div>0</div><div>0</div></td><td class="s">use Win32::IE::Form;</td></tr>
<tr><td class="h">1725</td><td><div class="c3">14</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1725">14</a></div></td><td></td><td><div>1000</div></td><td class="s">sub __new_form&nbsp;&nbsp;{ return Win32::IE::Form-&gt;new( @_ )&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1726</td><td colspan="7"></td></tr><tr><td class="h">1727</td><td><div class="c3">13</div><div class="c3">13</div><div class="c3">13</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1727">13</a></div></td><td></td><td><div>43005</div><div>0</div><div>0</div></td><td class="s">use Win32::IE::Input;</td></tr>
<tr><td class="h">1728</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1728">0</a></div></td><td></td><td><div>0</div></td><td class="s">sub __new_input { return Win32::IE::Input-&gt;new( @_ ) }</td></tr>
<tr><td class="h">1729</td><td colspan="7"></td></tr><tr><td class="h">1730</td><td><div class="c3">13</div><div class="c3">13</div><div class="c3">13</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1730">13</a></div></td><td></td><td><div>40005</div><div>1000</div><div>1000</div></td><td class="s">use Win32::IE::Link;</td></tr>
<tr><td class="h">1731</td><td><div class="c3">21</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1731">21</a></div></td><td></td><td><div>3000</div></td><td class="s">sub __new_link&nbsp;&nbsp;{ return Win32::IE::Link-&gt;new( @_ )&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1732</td><td colspan="7"></td></tr><tr><td class="h">1733</td><td><div class="c3">13</div><div class="c3">13</div><div class="c3">13</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1733">13</a></div></td><td></td><td><div>41003</div><div>0</div><div>3000</div></td><td class="s">use Win32::IE::Image;</td></tr>
<tr><td class="h">1734</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Win32-IE-Mechanize-pm--subroutine.html#L1734">2</a></div></td><td></td><td><div>0</div></td><td class="s">sub __new_image { return Win32::IE::Image-&gt;new( @_ ) }</td></tr>
<tr><td class="h">1735</td><td colspan="7"></td></tr><tr><td class="h">1736</td><td></td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
<tr><td class="h">1737</td><td colspan="7"></td></tr><tr><td class="h">1738 - 1796</td><td colspan="6"></td><td class="s"><pre>=head1 CAVEATS

The InternetExplorer automation object does not provide an interface
to the options menus. This means that you will need to set all options
needed for this automation before you start. This means that you may
need to set your security settings to a low and possibly unsafe level.

The InternetExplorer automation object does not provide an interface
to &quot;popup windows&quot; generated by security settings or JScript contained
in the page.

The InternetExplorer automation object does not provide an interface
to the content of frames from the toplevel document. This means that
you need to load the frame explicitly (using the follow_link()
method).

The basic authentication support is quite wonky and will only work
with the C&lt;get()&gt; method.

=head1 BUGS

Yes, there are bugs. The test-suite doesn&#39;t fully cover the codebase.

=over 4

=item frames

Some reports have come in regarding frames. So far nobody has been
able to provide me with a testcase, so I can&#39;t realy &quot;fix&quot; those.

=item forks

Gabor Szabo reported problems with forking and C&lt;use
Win32::IE::Mechanize&gt;. His workaround is to change the &quot;global&quot; C&lt;use
Win32::IE::Mechanize&gt; with localized C&lt;require Win32::IE::Mechanize&gt;
in the child&#39;s code.

=item encodings

Gabor Szabo reported problems with pages that use non-standard
encoding. In his case it turns out that somewhere along the line, the
right-to-left hebrew contents are lost.

=back

Please report bugs using L&lt;http://rt.cpan.org&gt;

=head1 COPYRIGHT AND LICENSE

Copyright MMIV, Abe Timmerman &lt;abeltje@cpan.org&gt;. All rights reserved

This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

=cut</pre></td></tr>
</table>
</body>
</html>
